![Cdor Depth Stencil Test Depth test Blending olor D...](Exported%20image%2020260112170943-0.png) ![v Blend Mode Render Type Render Queue Mask Clip Va...](Exported%20image%2020260112170945-1.png)

把镜子的RGBA都Mask上  
因为unity默认渲染队列 距离算的不准确 有可能先渲染前面的物体 导致后面的物体通过不了深度测试  
镜子要最先渲染设为1999 先渲染写入了深度  
所以后面渲染的物体都不能通过深度测试

![Exported image](Exported%20image%2020260112170946-2.png)

先渲染但不写入深度值即可解决

![Depth ZWrite Mode Offset Extra Depth Pass](Exported%20image%2020260112170948-3.png)  

![ranspareke 3000 From Shader Geometry AlphaTest Tr ...](Exported%20image%2020260112170952-4.png)

2000  
2450  
3000

2000 2450不透明  
2450 3000半透明
   
![Queue Index Vertex Output Shader LOD Fallback Cust...](Exported%20image%2020260112170954-5.png)

=2460

用freamDebug前 要

![G V Camera Clear Flags Culling Mask projection Fie...](Exported%20image%2020260112170955-6.png)
 
这时就有新的问题所在

解决方法：  
镜子绘制的时候可以clear正常的物体  
镜子2460  
在镜子里放一个天空盒队列为2465  
里面的物体2470  
天空盒子渲染的时候开启总是深度写入  
覆盖掉外面已经渲染好的物体深度  
也是因为通过了模板测试的天空盒像素才能到达深度测试  
并写入深度 覆盖外面的

![Exported image](Exported%20image%2020260112170957-7.png) ![v Camera Render v Drawing V RenderTexture R esolve...](Exported%20image%2020260112170959-8.png)

1.渲染队列2000的不透明物体渲染出来  
2.渲染队列2460的镜面 不要写入深度（挡住普通物体）写入模板值  
3.渲染队列2465的内部天空盒 写入深度（重点：写入新的深度 覆盖掉普通物体的深度 这样才能在新的世界从新安排深度） 总是通过深度测试（为了避免被普通物体挡住）为1的时候通过模板测试  
4渲染队列为2470的内部物体 写入深度 为1的时候通过模板测试

天空盒：重点是先模板测试通过了 然后深度全覆盖掉
# Unityå®æ—¶è¯­éŸ³å¯¹è¯APIä½¿ç”¨æ‰‹å†Œ

  

## ç›®å½•

1. [ç®€ä»‹](#ç®€ä»‹)

2. [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)

3. [ç³»ç»Ÿè¦æ±‚](#ç³»ç»Ÿè¦æ±‚)

4. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)

5. [APIå‚è€ƒ](#apiå‚è€ƒ)

6. [é«˜çº§ç”¨æ³•](#é«˜çº§ç”¨æ³•)

7. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

8. [é”™è¯¯å¤„ç†](#é”™è¯¯å¤„ç†)

9. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

  

---

  

## ç®€ä»‹

  

ç«å±±å¼•æ“å®æ—¶è¯­éŸ³å¯¹è¯APIï¼ˆVolcengine Realtime Dialog APIï¼‰æ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯çš„å®æ—¶è¯­éŸ³äº¤äº’ç³»ç»Ÿï¼Œæ”¯æŒï¼š

- ä½å»¶è¿Ÿè¯­éŸ³åˆ°è¯­éŸ³å¯¹è¯

- å®æ—¶è¯­éŸ³è¯†åˆ«ï¼ˆASRï¼‰

- å®æ—¶è¯­éŸ³åˆæˆï¼ˆTTSï¼‰

- å¤šæ¨¡å¼è¾“å…¥ï¼ˆè¯­éŸ³ã€æ–‡æœ¬ã€éŸ³é¢‘æ–‡ä»¶ï¼‰

- æµå¼äº¤äº’

  

æœ¬Unityå®ç°æä¾›äº†å®Œæ•´çš„C# APIå°è£…ï¼Œæ–¹ä¾¿åœ¨Unityé¡¹ç›®ä¸­é›†æˆå®æ—¶è¯­éŸ³å¯¹è¯åŠŸèƒ½ã€‚

  

---

  

## åŠŸèƒ½ç‰¹æ€§

  

### æ ¸å¿ƒåŠŸèƒ½

- âœ… WebSocketè¿æ¥ç®¡ç†

- âœ… å®æ—¶éº¦å…‹é£å½•éŸ³

- âœ… å®æ—¶éŸ³é¢‘æ’­æ”¾

- âœ… è¯­éŸ³è¯†åˆ«ï¼ˆASRï¼‰

- âœ… è¯­éŸ³åˆæˆï¼ˆTTSï¼‰

- âœ… æ–‡æœ¬è¾“å…¥/è¾“å‡º

- âœ… ä¼šè¯ç®¡ç†

- âœ… äº‹ä»¶é©±åŠ¨æ¶æ„

  

### æ”¯æŒçš„æ¨¡å‹ç‰ˆæœ¬

- **Oç‰ˆæœ¬** - æ”¯æŒç²¾å“éŸ³è‰²ï¼ˆvvã€xiaoheã€yunzhouã€xiaotianï¼‰

- **SCç‰ˆæœ¬** - æ”¯æŒå£°éŸ³å¤åˆ»

- **O2.0ç‰ˆæœ¬** - Oç‰ˆæœ¬å‡çº§ï¼Œå¢å¼ºå”±æ­Œèƒ½åŠ›

- **SC2.0ç‰ˆæœ¬** - SCç‰ˆæœ¬å‡çº§ï¼Œå¢å¼ºè§’è‰²æ¼”ç»

  

### æ”¯æŒçš„è¾“å…¥æ¨¡å¼

- **Audio** - éº¦å…‹é£å®æ—¶è¾“å…¥

- **AudioFile** - éŸ³é¢‘æ–‡ä»¶è¾“å…¥

- **Text** - çº¯æ–‡æœ¬è¾“å…¥

- **KeepAlive** - éº¦å…‹é£é™éŸ³ä¿æ´»æ¨¡å¼

  

---

  

## ç³»ç»Ÿè¦æ±‚

  

### Unityç‰ˆæœ¬

- Unity 2021.3 LTSæˆ–æ›´é«˜ç‰ˆæœ¬

- æ”¯æŒ.NET Standard 2.1

  

### ä¾èµ–é¡¹

- **UniTask** - ç”¨äºå¼‚æ­¥æ“ä½œï¼ˆå·²åœ¨é¡¹ç›®ä¸­ï¼‰

- **WebSocketåº“**ï¼ˆéœ€è¦é¢å¤–å®‰è£…ï¼‰:

Â  - æ¨èï¼šNativeWebSocket

Â  - æˆ–ï¼šWebSocketSharp

Â  - æˆ–ï¼šUnity WebSocket Package

  

### å¹³å°æ”¯æŒ

- âœ… Windowsï¼ˆç¼–è¾‘å™¨å’Œç‹¬ç«‹ç‰ˆæœ¬ï¼‰

- âœ… macOSï¼ˆç¼–è¾‘å™¨å’Œç‹¬ç«‹ç‰ˆæœ¬ï¼‰

- âœ… Androidï¼ˆéœ€è¦éº¦å…‹é£æƒé™ï¼‰

- âœ… iOSï¼ˆéœ€è¦éº¦å…‹é£æƒé™ï¼‰

- âš ï¸ WebGLï¼ˆWebSocketæ”¯æŒæœ‰é™ï¼‰

  

---

  

## å¿«é€Ÿå¼€å§‹

  

### 1. å‡†å¤‡å·¥ä½œ

  

#### è·å–APIå‡­è¯

1. è®¿é—®[ç«å±±å¼•æ“æ§åˆ¶å°](https://console.volcengine.com/)

2. å¼€é€š"è±†åŒ…ç«¯åˆ°ç«¯å®æ—¶è¯­éŸ³å¤§æ¨¡å‹"æœåŠ¡

3. è·å–ä»¥ä¸‹ä¿¡æ¯ï¼š

Â  Â - `API App ID`

Â  Â - `API Access Key`

  

#### å®‰è£…WebSocketåº“ï¼ˆä»¥NativeWebSocketä¸ºä¾‹ï¼‰

```bash

# ä½¿ç”¨Unity Package Managerå®‰è£…

https://github.com/endel/NativeWebSocket.git#upm

```

  

### 2. åŸºç¡€ä½¿ç”¨ç¤ºä¾‹

  

#### æ­¥éª¤1ï¼šåˆ›å»ºé…ç½®

åœ¨Unityç¼–è¾‘å™¨ä¸­åˆ›å»ºRTDConfigé…ç½®ï¼š

  

```csharp

using VolcEngine.RealtimeDialog;

using UnityEngine;

  

[CreateAssetMenu(fileName = "RTDConfig", menuName = "RealtimeDialog/Config")]

public class MyRTDConfig : ScriptableObject

{

Â  Â  public RTDConfig config;

}

```

  

#### æ­¥éª¤2ï¼šè®¾ç½®é…ç½®

åœ¨Inspectorä¸­å¡«å†™é…ç½®ï¼š

  

```yaml

wsUrl: "wss://openspeech.bytedance.com/api/v3/realtime/dialogue"

apiAppId: "YOUR_APP_ID"

apiAccessKey: "YOUR_ACCESS_KEY"

inputSampleRate: 16000

outputSampleRate: 24000

pcmFormat: Pcm_S16LE

defaultSpeaker: "zh_female_vv_jupiter_bigtts"

inputMode: Audio

modelVersion: O

botName: "è±†åŒ…"

enableVerboseLogging: true

```

  

#### æ­¥éª¤3ï¼šä½¿ç”¨API

  

```csharp

using UnityEngine;

using VolcEngine.RealtimeDialog;

  

public class SimpleExample : MonoBehaviour

{

Â  Â  [SerializeField] private RTDConfig config;

Â  Â  private IRealtimeDialogAPI api;

  

Â  Â  void Start()

Â  Â  {

Â  Â  Â  Â  // åˆ›å»ºAPIå®ä¾‹

Â  Â  Â  Â  GameObject apiObject = new GameObject("RealtimeDialogAPI");

Â  Â  Â  Â  api = apiObject.AddComponent<RealtimeDialogClient>();

  

Â  Â  Â  Â  // æ³¨å†Œäº‹ä»¶

Â  Â  Â  Â  api.OnConnected += () => Debug.Log("å·²è¿æ¥");

Â  Â  Â  Â  api.OnSessionStarted += (dialogId) => Debug.Log($"ä¼šè¯å¼€å§‹: {dialogId}");

Â  Â  Â  Â  api.OnASRTextReceived += (text, isInterim) => Debug.Log($"ASR: {text}");

Â  Â  Â  Â  api.OnChatTextReceived += (text, isInterim) => Debug.Log($"Chat: {text}");

  

Â  Â  Â  Â  // åˆå§‹åŒ–å¹¶è¿æ¥

Â  Â  Â  Â  api.Initialize(config);

Â  Â  Â  Â  api.Connect();

Â  Â  }

  

Â  Â  // å½“è¿æ¥æˆåŠŸåä¼šè‡ªåŠ¨è§¦å‘

Â  Â  void OnConnected()

Â  Â  {

Â  Â  Â  Â  // å¼€å§‹ä¼šè¯

Â  Â  Â  Â  api.StartSession();

Â  Â  }

  

Â  Â  // å½“ä¼šè¯å¼€å§‹å

Â  Â  void OnSessionStarted(string dialogId)

Â  Â  {

Â  Â  Â  Â  // å¯åŠ¨éº¦å…‹é£

Â  Â  Â  Â  api.StartMicrophone();

  

Â  Â  Â  Â  // æˆ–å‘é€æ–‡æœ¬

Â  Â  Â  Â  // api.SendTextQuery("ä½ å¥½");

Â  Â  }

  

Â  Â  void OnDestroy()

Â  Â  {

Â  Â  Â  Â  api?.Disconnect();

Â  Â  }

}

```

  

---

  

## APIå‚è€ƒ

  

### æ ¸å¿ƒæ¥å£ï¼šIRealtimeDialogAPI

  

#### å±æ€§

  

| å±æ€§ | ç±»å‹ | è¯´æ˜ |

|------|------|------|

| `CurrentState` | `RTDState` | å½“å‰çŠ¶æ€ |

| `IsConnected` | `bool` | æ˜¯å¦å·²è¿æ¥ |

| `IsSessionActive` | `bool` | ä¼šè¯æ˜¯å¦æ´»è·ƒ |

| `SessionId` | `string` | å½“å‰ä¼šè¯ID |

| `IsMicrophoneRecording` | `bool` | éº¦å…‹é£æ˜¯å¦å½•éŸ³ä¸­ |

| `IsPlaybackMuted` | `bool` | æ’­æ”¾æ˜¯å¦é™éŸ³ |

  

#### æ ¸å¿ƒæ–¹æ³•

  

##### `void Initialize(RTDConfig config)`

åˆå§‹åŒ–APIï¼Œå¿…é¡»é¦–å…ˆè°ƒç”¨ã€‚

  

```csharp

api.Initialize(config);

```

  

##### `void Connect()`

è¿æ¥åˆ°æœåŠ¡å™¨ã€‚

  

```csharp

api.Connect();

```

  

##### `void Disconnect()`

æ–­å¼€è¿æ¥ã€‚

  

```csharp

api.Disconnect();

```

  

##### `void StartSession()`

å¼€å§‹ä¼šè¯ï¼ˆå¿…é¡»åœ¨è¿æ¥æˆåŠŸåè°ƒç”¨ï¼‰ã€‚

  

```csharp

api.StartSession();

```

  

##### `void EndSession()`

ç»“æŸä¼šè¯ã€‚

  

```csharp

api.EndSession();

```

  

##### `void SendAudioData(byte[] audioData)`

å‘é€éŸ³é¢‘æ•°æ®ï¼ˆPCMæ ¼å¼ï¼‰ã€‚

  

```csharp

byte[] pcmData = GetMicrophoneData();

api.SendAudioData(pcmData);

```

  

##### `void SendTextQuery(string text)`

å‘é€æ–‡æœ¬æŸ¥è¯¢ã€‚

  

```csharp

api.SendTextQuery("ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ");

```

  

##### `void SendGreeting(string greeting)`

å‘é€é—®å€™æ¶ˆæ¯ã€‚

  

```csharp

api.SendGreeting("ä½ å¥½ï¼Œæˆ‘æ˜¯è±†åŒ…");

```

  

#### éŸ³é¢‘æ§åˆ¶æ–¹æ³•

  

##### `void StartMicrophone()`

å¯åŠ¨éº¦å…‹é£å½•éŸ³ã€‚

  

```csharp

api.StartMicrophone();

```

  

##### `void StopMicrophone()`

åœæ­¢éº¦å…‹é£å½•éŸ³ã€‚

  

```csharp

api.StopMicrophone();

```

  

##### `void MutePlayback(bool mute)`

é™éŸ³/å–æ¶ˆé™éŸ³æ’­æ”¾ã€‚

  

```csharp

api.MutePlayback(true); // é™éŸ³

api.MutePlayback(false); // å–æ¶ˆé™éŸ³

```

  

#### é«˜çº§æ–¹æ³•

  

##### `void SendAudioFile(string filePath, int chunkSize, int intervalMs)`

å‘é€éŸ³é¢‘æ–‡ä»¶ï¼ˆæ¨¡æ‹Ÿæµå¼å‘é€ï¼‰ã€‚

  

```csharp

api.SendAudioFile("path/to/audio.pcm", 640, 20);

```

  

##### `void SaveReceivedAudio(string filePath)`

ä¿å­˜æ¥æ”¶åˆ°çš„éŸ³é¢‘æ•°æ®ã€‚

  

```csharp

api.SaveReceivedAudio("output.pcm");

```

  

##### `byte[] GetReceivedAudioData()`

è·å–æ¥æ”¶åˆ°çš„éŸ³é¢‘æ•°æ®ã€‚

  

```csharp

byte[] audioData = api.GetReceivedAudioData();

```

  

#### äº‹ä»¶

  

| äº‹ä»¶ | ç­¾å | è¯´æ˜ |

|------|------|------|

| `OnStateChanged` | `event RTDStateCallback` | çŠ¶æ€å˜åŒ– |

| `OnConnected` | `event Action` | è¿æ¥æˆåŠŸ |

| `OnDisconnected` | `event Action` | è¿æ¥æ–­å¼€ |

| `OnSessionStarted` | `event Action<string>` | ä¼šè¯å¼€å§‹ï¼ˆdialog_idï¼‰ |

| `OnSessionEnded` | `event Action` | ä¼šè¯ç»“æŸ |

| `OnAudioReceived` | `event RTDAudioCallback` | æ¥æ”¶åˆ°éŸ³é¢‘ |

| `OnASRTextReceived` | `event RTDTextCallback` | æ¥æ”¶åˆ°ASRæ–‡æœ¬ |

| `OnChatTextReceived` | `event RTDTextCallback` | æ¥æ”¶åˆ°èŠå¤©æ–‡æœ¬ |

| `OnUserSpeakingStart` | `event Action<string>` | ç”¨æˆ·å¼€å§‹è¯´è¯ |

| `OnUserSpeakingEnd` | `event Action` | ç”¨æˆ·åœæ­¢è¯´è¯ |

| `OnTTSStart` | `event Action<string, string>` | TTSå¼€å§‹ |

| `OnTTSEnd` | `event Action` | TTSç»“æŸ |

| `OnError` | `event RTDErrorCallback` | é”™è¯¯äº‹ä»¶ |

  

#### äº‹ä»¶ä½¿ç”¨ç¤ºä¾‹

  

```csharp

// æ³¨å†Œäº‹ä»¶

api.OnASRTextReceived += (text, isInterim) => {

Â  Â  if (!isInterim) {

Â  Â  Â  Â  Debug.Log($"æœ€ç»ˆè¯†åˆ«ç»“æœ: {text}");

Â  Â  } else {

Â  Â  Â  Â  Debug.Log($"ä¸´æ—¶è¯†åˆ«ç»“æœ: {text}");

Â  Â  }

};

  

api.OnChatTextReceived += (text, isInterim) => {

Â  Â  // æµå¼æ¥æ”¶èŠå¤©æ–‡æœ¬

Â  Â  chatTextUI.text += text;

};

  

api.OnUserSpeakingStart += (questionId) => {

Â  Â  Debug.Log("ç”¨æˆ·å¼€å§‹è¯´è¯ï¼Œå‡†å¤‡æ‰“æ–­TTS");

Â  Â  api.MutePlayback(true);

};

  

api.OnError += (error, errorCode) => {

Â  Â  Debug.LogError($"é”™è¯¯[{errorCode}]: {error}");

};

```

  

---

  

## é«˜çº§ç”¨æ³•

  

### 1. å®Œæ•´çš„å¯¹è¯æµç¨‹

  

```csharp

public class AdvancedDialog : MonoBehaviour

{

Â  Â  private IRealtimeDialogAPI api;

Â  Â  private bool autoReconnect = true;

  

Â  Â  void Start()

Â  Â  {

Â  Â  Â  Â  SetupAPI();

Â  Â  }

  

Â  Â  void SetupAPI()

Â  Â  {

Â  Â  Â  Â  // åˆ›å»ºAPI

Â  Â  Â  Â  api = gameObject.AddComponent<RealtimeDialogClient>();

  

Â  Â  Â  Â  // æ³¨å†Œæ‰€æœ‰äº‹ä»¶

Â  Â  Â  Â  RegisterAllEvents();

  

Â  Â  Â  Â  // åˆå§‹åŒ–å¹¶è¿æ¥

Â  Â  Â  Â  api.Initialize(config);

Â  Â  Â  Â  api.Connect();

Â  Â  }

  

Â  Â  void RegisterAllEvents()

Â  Â  {

Â  Â  Â  Â  // è¿æ¥äº‹ä»¶

Â  Â  Â  Â  api.OnConnected += () => {

Â  Â  Â  Â  Â  Â  Debug.Log("âœ… è¿æ¥æˆåŠŸ");

Â  Â  Â  Â  Â  Â  api.StartSession();

Â  Â  Â  Â  };

  

Â  Â  Â  Â  api.OnDisconnected += () => {

Â  Â  Â  Â  Â  Â  Debug.Log("âŒ è¿æ¥æ–­å¼€");

Â  Â  Â  Â  Â  Â  if (autoReconnect) {

Â  Â  Â  Â  Â  Â  Â  Â  StartCoroutine(ReconnectAfterDelay(5f));

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  };

  

Â  Â  Â  Â  // ä¼šè¯äº‹ä»¶

Â  Â  Â  Â  api.OnSessionStarted += (dialogId) => {

Â  Â  Â  Â  Â  Â  Debug.Log($"âœ… ä¼šè¯å¼€å§‹: {dialogId}");

Â  Â  Â  Â  Â  Â  api.SendGreeting("ä½ å¥½ï¼Œæˆ‘æ˜¯è±†åŒ…");

Â  Â  Â  Â  Â  Â  api.StartMicrophone();

Â  Â  Â  Â  };

  

Â  Â  Â  Â  api.OnSessionEnded += () => {

Â  Â  Â  Â  Â  Â  Debug.Log("â¹ï¸ ä¼šè¯ç»“æŸ");

Â  Â  Â  Â  Â  Â  api.StopMicrophone();

Â  Â  Â  Â  };

  

Â  Â  Â  Â  // ç”¨æˆ·è¯´è¯äº‹ä»¶

Â  Â  Â  Â  api.OnUserSpeakingStart += (questionId) => {

Â  Â  Â  Â  Â  Â  Debug.Log("ğŸ—£ï¸ ç”¨æˆ·å¼€å§‹è¯´è¯");

Â  Â  Â  Â  Â  Â  // æ‰“æ–­å½“å‰æ’­æ”¾

Â  Â  Â  Â  Â  Â  api.MutePlayback(true);

Â  Â  Â  Â  };

  

Â  Â  Â  Â  api.OnUserSpeakingEnd += () => {

Â  Â  Â  Â  Â  Â  Debug.Log("ğŸ¤ ç”¨æˆ·åœæ­¢è¯´è¯");

Â  Â  Â  Â  Â  Â  api.MutePlayback(false);

Â  Â  Â  Â  };

  

Â  Â  Â  Â  // æ–‡æœ¬äº‹ä»¶

Â  Â  Â  Â  api.OnASRTextReceived += (text, isInterim) => {

Â  Â  Â  Â  Â  Â  if (!isInterim) {

Â  Â  Â  Â  Â  Â  Â  Â  OnASRFinalText(text);

Â  Â  Â  Â  Â  Â  } else {

Â  Â  Â  Â  Â  Â  Â  Â  OnASRInterimText(text);

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  };

  

Â  Â  Â  Â  api.OnChatTextReceived += (text, isInterim) => {

Â  Â  Â  Â  Â  Â  OnChatText(text, isInterim);

Â  Â  Â  Â  };

  

Â  Â  Â  Â  // TTSäº‹ä»¶

Â  Â  Â  Â  api.OnTTSStart += (ttsType, text) => {

Â  Â  Â  Â  Â  Â  Debug.Log($"ğŸ”Š TTSå¼€å§‹ [{ttsType}]: {text}");

Â  Â  Â  Â  };

  

Â  Â  Â  Â  api.OnTTSEnd += () => {

Â  Â  Â  Â  Â  Â  Debug.Log("ğŸ”‡ TTSç»“æŸ");

Â  Â  Â  Â  };

  

Â  Â  Â  Â  // éŸ³é¢‘äº‹ä»¶

Â  Â  Â  Â  api.OnAudioReceived += (audioData) => {

Â  Â  Â  Â  Â  Â  OnAudioReceived(audioData);

Â  Â  Â  Â  };

  

Â  Â  Â  Â  // é”™è¯¯äº‹ä»¶

Â  Â  Â  Â  api.OnError += (error, errorCode) => {

Â  Â  Â  Â  Â  Â  HandleError(error, errorCode);

Â  Â  Â  Â  };

Â  Â  }

  

Â  Â  IEnumerator ReconnectAfterDelay(float delay)

Â  Â  {

Â  Â  Â  Â  yield return new WaitForSeconds(delay);

Â  Â  Â  Â  if (!api.IsConnected)

Â  Â  Â  Â  {

Â  Â  Â  Â  Â  Â  Debug.Log("å°è¯•é‡æ–°è¿æ¥...");

Â  Â  Â  Â  Â  Â  api.Connect();

Â  Â  Â  Â  }

Â  Â  }

  

Â  Â  void OnASRFinalText(string text)

Â  Â  {

Â  Â  Â  Â  Debug.Log($"ğŸ¤ [æœ€ç»ˆ] {text}");

Â  Â  Â  Â  // æ›´æ–°UIæ˜¾ç¤ºç”¨æˆ·è¯´çš„è¯

Â  Â  Â  Â  userTextUI.text = text;

Â  Â  }

  

Â  Â  void OnASRInterimText(string text)

Â  Â  {

Â  Â  Â  Â  Debug.Log($"ğŸ¤ [ä¸´æ—¶] {text}");

Â  Â  Â  Â  // å®æ—¶æ›´æ–°UI

Â  Â  Â  Â  userTextUI.text = text;

Â  Â  }

  

Â  Â  void OnChatText(string text, bool isInterim)

Â  Â  {

Â  Â  Â  Â  // æµå¼æ˜¾ç¤ºAIå›å¤

Â  Â  Â  Â  if (isInterim)

Â  Â  Â  Â  {

Â  Â  Â  Â  Â  Â  chatTextUI.text += text;

Â  Â  Â  Â  }

Â  Â  Â  Â  else

Â  Â  Â  Â  {

Â  Â  Â  Â  Â  Â  // å®Œæ•´æ–‡æœ¬

Â  Â  Â  Â  Â  Â  Debug.Log($"ğŸ’¬ [å®Œæ•´] {text}");

Â  Â  Â  Â  }

Â  Â  }

  

Â  Â  void OnAudioReceived(byte[] audioData)

Â  Â  {

Â  Â  Â  Â  // å¯ä»¥ä¿å­˜æˆ–å¤„ç†éŸ³é¢‘æ•°æ®

Â  Â  Â  Â  // ä¾‹å¦‚ï¼šå®æ—¶å¯è§†åŒ–éŸ³é¢‘æ³¢å½¢

Â  Â  }

  

Â  Â  void HandleError(string error, int errorCode)

Â  Â  {

Â  Â  Â  Â  Debug.LogError($"âŒ é”™è¯¯ [{errorCode}]: {error}");

  

Â  Â  Â  Â  switch (errorCode)

Â  Â  Â  Â  {

Â  Â  Â  Â  Â  Â  case 45000002:

Â  Â  Â  Â  Â  Â  Â  Â  Debug.LogError("é”™è¯¯ï¼šä¸Šä¼ äº†ç©ºéŸ³é¢‘");

Â  Â  Â  Â  Â  Â  Â  Â  break;

Â  Â  Â  Â  Â  Â  case 45000003:

Â  Â  Â  Â  Â  Â  Â  Â  Debug.LogError("é”™è¯¯ï¼š10åˆ†é’Ÿé™éŸ³ï¼Œè¿æ¥å·²é‡Šæ”¾");

Â  Â  Â  Â  Â  Â  Â  Â  api.Disconnect();

Â  Â  Â  Â  Â  Â  Â  Â  break;

Â  Â  Â  Â  Â  Â  case 55000001:

Â  Â  Â  Â  Â  Â  Â  Â  Debug.LogError("é”™è¯¯ï¼šæœåŠ¡å™¨å¤„ç†é”™è¯¯");

Â  Â  Â  Â  Â  Â  Â  Â  break;

Â  Â  Â  Â  Â  Â  default:

Â  Â  Â  Â  Â  Â  Â  Â  Debug.LogError($"æœªçŸ¥é”™è¯¯ä»£ç : {errorCode}");

Â  Â  Â  Â  Â  Â  Â  Â  break;

Â  Â  Â  Â  }

Â  Â  }

  

Â  Â  void OnDestroy()

Â  Â  {

Â  Â  Â  Â  api?.StopMicrophone();

Â  Â  Â  Â  api?.Disconnect();

Â  Â  }

}

```

  

### 2. å¤šéŸ³è‰²åˆ‡æ¢

  

```csharp

public class MultiSpeakerExample : MonoBehaviour

{

Â  Â  private IRealtimeDialogAPI api;

  

Â  Â  // å¯ç”¨éŸ³è‰²åˆ—è¡¨

Â  Â  private string[] speakers = new string[]

Â  Â  {

Â  Â  Â  Â  "zh_female_vv_jupiter_bigtts", Â  Â  Â // vv - æ´»æ³¼çµåŠ¨å¥³å£°

Â  Â  Â  Â  "zh_female_xiaohe_jupiter_bigtts", Â  // xiaohe - ç”œç¾æ´»æ³¼å¥³å£°

Â  Â  Â  Â  "zh_male_yunzhou_jupiter_bigtts", Â  Â // yunzhou - æ¸…çˆ½æ²‰ç¨³ç”·å£°

Â  Â  Â  Â  "zh_male_xiaotian_jupiter_bigtts" Â  Â // xiaotian - æ¸…çˆ½ç£æ€§ç”·å£°

Â  Â  };

  

Â  Â  private int currentSpeakerIndex = 0;

  

Â  Â  public void SwitchToNextSpeaker()

Â  Â  {

Â  Â  Â  Â  // åˆ‡æ¢éŸ³è‰²éœ€è¦é‡æ–°å¼€å§‹ä¼šè¯

Â  Â  Â  Â  api.EndSession();

  

Â  Â  Â  Â  currentSpeakerIndex = (currentSpeakerIndex + 1) % speakers.Length;

Â  Â  Â  Â  config.defaultSpeaker = speakers[currentSpeakerIndex];

  

Â  Â  Â  Â  api.UpdateConfig(config);

Â  Â  Â  Â  api.StartSession();

  

Â  Â  Â  Â  Debug.Log($"åˆ‡æ¢åˆ°éŸ³è‰²: {speakers[currentSpeakerIndex]}");

Â  Â  }

}

```

  

### 3. éŸ³é¢‘æ–‡ä»¶å¤„ç†

  

```csharp

public class AudioFileExample : MonoBehaviour

{

Â  Â  private IRealtimeDialogAPI api;

  

Â  Â  public void ProcessAudioFile(string filePath)

Â  Â  {

Â  Â  Â  Â  StartCoroutine(ProcessAudioFileRoutine(filePath));

Â  Â  }

  

Â  Â  IEnumerator ProcessAudioFileRoutine(string filePath)

Â  Â  {

Â  Â  Â  Â  // ç¡®ä¿è¿æ¥

Â  Â  Â  Â  if (!api.IsConnected)

Â  Â  Â  Â  {

Â  Â  Â  Â  Â  Â  api.Connect();

Â  Â  Â  Â  Â  Â  yield return new WaitUntil(() => api.IsConnected);

Â  Â  Â  Â  }

  

Â  Â  Â  Â  // ç¡®ä¿ä¼šè¯æ´»è·ƒ

Â  Â  Â  Â  if (!api.IsSessionActive)

Â  Â  Â  Â  {

Â  Â  Â  Â  Â  Â  api.StartSession();

Â  Â  Â  Â  Â  Â  yield return new WaitUntil(() => api.IsSessionActive);

Â  Â  Â  Â  }

  

Â  Â  Â  Â  // å‘é€éŸ³é¢‘æ–‡ä»¶

Â  Â  Â  Â  Debug.Log($"å¼€å§‹å‘é€éŸ³é¢‘æ–‡ä»¶: {filePath}");

Â  Â  Â  Â  api.SendAudioFile(filePath, 640, 20);

Â  Â  }

  

Â  Â  public void SaveReceivedAudio()

Â  Â  {

Â  Â  Â  Â  string timestamp = System.DateTime.Now.ToString("yyyyMMdd_HHmmss");

Â  Â  Â  Â  string filePath = $"{Application.dataPath}/received_audio_{timestamp}.pcm";

Â  Â  Â  Â  api.SaveReceivedAudio(filePath);

Â  Â  Â  Â  Debug.Log($"éŸ³é¢‘å·²ä¿å­˜: {filePath}");

Â  Â  }

}

```

  

### 4. æ–‡æœ¬æ¨¡å¼ä½¿ç”¨

  

```csharp

public class TextModeExample : MonoBehaviour

{

Â  Â  private IRealtimeDialogAPI api;

  

Â  Â  void Start()

Â  Â  {

Â  Â  Â  Â  // é…ç½®ä¸ºæ–‡æœ¬æ¨¡å¼

Â  Â  Â  Â  config.inputMode = InputMode.Text;

  

Â  Â  Â  Â  api = gameObject.AddComponent<RealtimeDialogClient>();

Â  Â  Â  Â  api.Initialize(config);

  

Â  Â  Â  Â  // æ³¨å†Œäº‹ä»¶

Â  Â  Â  Â  api.OnSessionStarted += (dialogId) => {

Â  Â  Â  Â  Â  Â  Debug.Log("ä¼šè¯å¼€å§‹ï¼Œå¯ä»¥å‘é€æ–‡æœ¬äº†");

Â  Â  Â  Â  };

  

Â  Â  Â  Â  api.OnChatTextReceived += (text, isInterim) => {

Â  Â  Â  Â  Â  Â  Debug.Log($"AIå›å¤: {text}");

Â  Â  Â  Â  };

  

Â  Â  Â  Â  // è¿æ¥å¹¶å¼€å§‹ä¼šè¯

Â  Â  Â  Â  api.Connect();

Â  Â  }

  

Â  Â  public void SendUserMessage(string message)

Â  Â  {

Â  Â  Â  Â  if (api.IsSessionActive)

Â  Â  Â  Â  {

Â  Â  Â  Â  Â  Â  api.SendTextQuery(message);

Â  Â  Â  Â  }

Â  Â  }

}

```

  

---

  

## å¸¸è§é—®é¢˜

  

### Q1: å¦‚ä½•é›†æˆWebSocketåº“ï¼Ÿ

  

**A:** æ¨èä½¿ç”¨NativeWebSocketï¼š

  

1. åœ¨Unity Package Managerä¸­æ·»åŠ ï¼š

```

https://github.com/endel/NativeWebSocket.git#upm

```

  

2. åœ¨`RealtimeDialogClient.cs`ä¸­å®ç°WebSocketè¿æ¥ï¼š

```csharp

using NativeWebSocket;

  

private WebSocket _webSocket;

  

private async UniTask ConnectWebSocketAsync()

{

Â  Â  _webSocket = new WebSocket(_config.wsUrl);

  

Â  Â  _webSocket.OnOpen += () => {

Â  Â  Â  Â  Debug.Log("WebSocketå·²æ‰“å¼€");

Â  Â  };

  

Â  Â  _webSocket.OnMessage += (bytes) => {

Â  Â  Â  Â  HandleWebSocketMessage(bytes);

Â  Â  };

  

Â  Â  _webSocket.OnError += (error) => {

Â  Â  Â  Â  Debug.LogError($"WebSocketé”™è¯¯: {error}");

Â  Â  };

  

Â  Â  _webSocket.OnClose += (code) => {

Â  Â  Â  Â  Debug.Log($"WebSocketå·²å…³é—­: {code}");

Â  Â  };

  

Â  Â  await _webSocket.Connect();

}

```

  

### Q2: éº¦å…‹é£æƒé™å¦‚ä½•å¤„ç†ï¼Ÿ

  

**A:** åœ¨ä¸åŒå¹³å°ä¸Šå¤„ç†ï¼š

  

**Android:**

åœ¨`AndroidManifest.xml`ä¸­æ·»åŠ ï¼š

```xml

<uses-permission android:name="android.permission.RECORD_AUDIO"/>

<uses-permission android:name="android.permission.MODIFY_AUDIO_SETTINGS"/>

```

  

åœ¨ä»£ç ä¸­è¯·æ±‚æƒé™ï¼š

```csharp

#if UNITY_ANDROID

if (!Permission.HasUserAuthorizedPermission(Permission.Microphone))

{

Â  Â  Permission.RequestUserPermission(Permission.Microphone);

}

#endif

```

  

**iOS:**

åœ¨`Info.plist`ä¸­æ·»åŠ ï¼š

```xml

<key>NSMicrophoneUsageDescription</key>

<string>éœ€è¦è®¿é—®éº¦å…‹é£ä»¥è¿›è¡Œè¯­éŸ³å¯¹è¯</string>

```

  

### Q3: å¦‚ä½•å¤„ç†ç½‘ç»œæ–­çº¿é‡è¿ï¼Ÿ

  

**A:** å®ç°è‡ªåŠ¨é‡è¿é€»è¾‘ï¼š

  

```csharp

private int reconnectAttempts = 0;

private int maxReconnectAttempts = 5;

private float reconnectDelay = 5f;

  

api.OnDisconnected += () => {

Â  Â  if (reconnectAttempts < maxReconnectAttempts)

Â  Â  {

Â  Â  Â  Â  reconnectAttempts++;

Â  Â  Â  Â  Debug.Log($"å°è¯•é‡æ–°è¿æ¥ ({reconnectAttempts}/{maxReconnectAttempts})...");

Â  Â  Â  Â  StartCoroutine(ReconnectAfterDelay(reconnectDelay));

Â  Â  }

Â  Â  else

Â  Â  {

Â  Â  Â  Â  Debug.LogError("é‡è¿å¤±è´¥ï¼Œå·²è¾¾åˆ°æœ€å¤§å°è¯•æ¬¡æ•°");

Â  Â  }

};

  

api.OnConnected += () => {

Â  Â  reconnectAttempts = 0; // é‡ç½®è®¡æ•°

};

  

IEnumerator ReconnectAfterDelay(float delay)

{

Â  Â  yield return new WaitForSeconds(delay);

Â  Â  api.Connect();

}

```

  

### Q4: éŸ³é¢‘æ ¼å¼å¦‚ä½•é€‰æ‹©ï¼Ÿ

  

**A:**

- **Pcm_S16LE** (16ä½å°ç«¯åºPCM)ï¼šæ¨èç”¨äºç§»åŠ¨è®¾å¤‡ï¼ŒèŠ‚çœå¸¦å®½

- **Pcm_F32LE** (32ä½æµ®ç‚¹PCM)ï¼šæ¨èç”¨äºæ¡Œé¢å¹³å°ï¼ŒéŸ³è´¨æ›´å¥½

  

é…ç½®ç¤ºä¾‹ï¼š

```csharp

// ç§»åŠ¨è®¾å¤‡

config.pcmFormat = PcmFormat.Pcm_S16LE;

config.outputSampleRate = 24000;

  

// æ¡Œé¢è®¾å¤‡

config.pcmFormat = PcmFormat.Pcm_F32LE;

config.outputSampleRate = 24000;

```

  

### Q5: å¦‚ä½•å®ç°æ‰“æ–­åŠŸèƒ½ï¼Ÿ

  

**A:** ç›‘å¬ç”¨æˆ·è¯´è¯äº‹ä»¶å¹¶é™éŸ³æ’­æ”¾ï¼š

  

```csharp

api.OnUserSpeakingStart += (questionId) => {

Â  Â  // ç”¨æˆ·å¼€å§‹è¯´è¯æ—¶æ‰“æ–­AIæ’­æ”¾

Â  Â  api.MutePlayback(true);

Â  Â  Debug.Log("ç”¨æˆ·è¯´è¯ï¼ŒAIè¢«æ‰“æ–­");

};

  

api.OnTTSEnd += () => {

Â  Â  // TTSç»“æŸåæ¢å¤æ’­æ”¾

Â  Â  api.MutePlayback(false);

};

```

  

---

  

## é”™è¯¯å¤„ç†

  

### é”™è¯¯ç è¯´æ˜

  

| é”™è¯¯ç  | è¯´æ˜ | å¤„ç†å»ºè®® |

|--------|------|----------|

| 45000002 | ç©ºéŸ³é¢‘åŒ… | æ£€æŸ¥éº¦å…‹é£æ˜¯å¦æ­£å¸¸å·¥ä½œ |

| 45000003 | 10åˆ†é’Ÿé™éŸ³è¶…æ—¶ | é‡æ–°è¿æ¥ |

| 55000001 | æœåŠ¡å™¨å¤„ç†é”™è¯¯ | æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œé‡è¯• |

| 55000030 | æœåŠ¡ä¸å¯ç”¨ | ç¨åé‡è¯• |

| 55002070 | ä¸‹æ¸¸æœåŠ¡é”™è¯¯ | è”ç³»æŠ€æœ¯æ”¯æŒ |

  

### é”™è¯¯å¤„ç†ç¤ºä¾‹

  

```csharp

api.OnError += (error, errorCode) => {

Â  Â  switch (errorCode)

Â  Â  {

Â  Â  Â  Â  case 45000002:

Â  Â  Â  Â  Â  Â  Debug.LogWarning("æ£€æµ‹åˆ°ç©ºéŸ³é¢‘ï¼Œè¯·æ£€æŸ¥éº¦å…‹é£");

Â  Â  Â  Â  Â  Â  RestartMicrophone();

Â  Â  Â  Â  Â  Â  break;

  

Â  Â  Â  Â  case 45000003:

Â  Â  Â  Â  Â  Â  Debug.LogWarning("é™éŸ³è¶…æ—¶ï¼Œé‡æ–°è¿æ¥");

Â  Â  Â  Â  Â  Â  api.Disconnect();

Â  Â  Â  Â  Â  Â  api.Connect();

Â  Â  Â  Â  Â  Â  break;

  

Â  Â  Â  Â  case 55000001:

Â  Â  Â  Â  Â  Â  Debug.LogError("æœåŠ¡å™¨é”™è¯¯ï¼Œå°è¯•é‡è¿");

Â  Â  Â  Â  Â  Â  RetryConnection();

Â  Â  Â  Â  Â  Â  break;

  

Â  Â  Â  Â  case 55000030:

Â  Â  Â  Â  Â  Â  Debug.LogError("æœåŠ¡ä¸å¯ç”¨");

Â  Â  Â  Â  Â  Â  ShowErrorToUser("æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ç¨åé‡è¯•");

Â  Â  Â  Â  Â  Â  break;

  

Â  Â  Â  Â  default:

Â  Â  Â  Â  Â  Â  Debug.LogError($"æœªçŸ¥é”™è¯¯ [{errorCode}]: {error}");

Â  Â  Â  Â  Â  Â  break;

Â  Â  }

};

  

void RestartMicrophone()

{

Â  Â  api.StopMicrophone();

Â  Â  StartCoroutine(DelayedStartMicrophone(1f));

}

  

IEnumerator DelayedStartMicrophone(float delay)

{

Â  Â  yield return new WaitForSeconds(delay);

Â  Â  api.StartMicrophone();

}

```

  

---

  

## æœ€ä½³å®è·µ

  

### 1. èµ„æºç®¡ç†

  

```csharp

public class ProperResourceManagement : MonoBehaviour

{

Â  Â  private IRealtimeDialogAPI api;

  

Â  Â  void OnEnable()

Â  Â  {

Â  Â  Â  Â  InitializeAPI();

Â  Â  }

  

Â  Â  void OnDisable()

Â  Â  {

Â  Â  Â  Â  CleanupAPI();

Â  Â  }

  

Â  Â  void OnApplicationPause(bool pauseStatus)

Â  Â  {

Â  Â  Â  Â  if (pauseStatus)

Â  Â  Â  Â  {

Â  Â  Â  Â  Â  Â  // åº”ç”¨æš‚åœæ—¶åœæ­¢éº¦å…‹é£

Â  Â  Â  Â  Â  Â  api?.StopMicrophone();

Â  Â  Â  Â  }

Â  Â  Â  Â  else

Â  Â  Â  Â  {

Â  Â  Â  Â  Â  Â  // åº”ç”¨æ¢å¤æ—¶é‡å¯éº¦å…‹é£

Â  Â  Â  Â  Â  Â  if (api?.IsSessionActive == true)

Â  Â  Â  Â  Â  Â  {

Â  Â  Â  Â  Â  Â  Â  Â  api?.StartMicrophone();

Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  }

Â  Â  }

  

Â  Â  void OnApplicationFocus(bool hasFocus)

Â  Â  {

Â  Â  Â  Â  if (!hasFocus)

Â  Â  Â  Â  {

Â  Â  Â  Â  Â  Â  // å¤±å»ç„¦ç‚¹æ—¶é™éŸ³

Â  Â  Â  Â  Â  Â  api?.MutePlayback(true);

Â  Â  Â  Â  }

Â  Â  Â  Â  else

Â  Â  Â  Â  {

Â  Â  Â  Â  Â  Â  api?.MutePlayback(false);

Â  Â  Â  Â  }

Â  Â  }

  

Â  Â  void CleanupAPI()

Â  Â  {

Â  Â  Â  Â  api?.StopMicrophone();

Â  Â  Â  Â  api?.EndSession();

Â  Â  Â  Â  api?.Disconnect();

Â  Â  }

  

Â  Â  void OnDestroy()

Â  Â  {

Â  Â  Â  Â  CleanupAPI();

Â  Â  }

}

```

  

### 2. æ€§èƒ½ä¼˜åŒ–

  

```csharp

public class PerformanceOptimization : MonoBehaviour

{

Â  Â  private IRealtimeDialogAPI api;

  

Â  Â  void Awake()

Â  Â  {

Â  Â  Â  Â  // é™åˆ¶å¸§ç‡ä»¥é™ä½CPUä½¿ç”¨

Â  Â  Â  Â  Application.targetFrameRate = 60;

  

Â  Â  Â  Â  // ç¦ç”¨ä¸å¿…è¦çš„æ—¥å¿—

Â  Â  Â  Â  config.enableVerboseLogging = false;

Â  Â  }

  

Â  Â  void Start()

Â  Â  {

Â  Â  Â  Â  // ä½¿ç”¨å¯¹è±¡æ± ç®¡ç†éŸ³é¢‘ç¼“å†²åŒº

Â  Â  Â  Â  InitializeAudioBufferPool();

Â  Â  }

  

Â  Â  void InitializeAudioBufferPool()

Â  Â  {

Â  Â  Â  Â  // å®ç°éŸ³é¢‘ç¼“å†²åŒºå¯¹è±¡æ± 

Â  Â  Â  Â  // é¿å…é¢‘ç¹åˆ†é…å’Œé‡Šæ”¾å†…å­˜

Â  Â  }

}

```

  

### 3. UIå“åº”æ€§

  

```csharp

public class ResponsiveUI : MonoBehaviour

{

Â  Â  [SerializeField] private Text statusText;

Â  Â  [SerializeField] private Image connectionIndicator;

Â  Â  [SerializeField] private GameObject loadingSpinner;

  

Â  Â  void Start()

Â  Â  {

Â  Â  Â  Â  api.OnStateChanged += UpdateUIForState;

Â  Â  }

  

Â  Â  void UpdateUIForState(RTDState state)

Â  Â  {

Â  Â  Â  Â  switch (state)

Â  Â  Â  Â  {

Â  Â  Â  Â  Â  Â  case RTDState.Disconnected:

Â  Â  Â  Â  Â  Â  Â  Â  statusText.text = "æœªè¿æ¥";

Â  Â  Â  Â  Â  Â  Â  Â  connectionIndicator.color = Color.red;

Â  Â  Â  Â  Â  Â  Â  Â  loadingSpinner.SetActive(false);

Â  Â  Â  Â  Â  Â  Â  Â  break;

  

Â  Â  Â  Â  Â  Â  case RTDState.Connecting:

Â  Â  Â  Â  Â  Â  Â  Â  statusText.text = "è¿æ¥ä¸­...";

Â  Â  Â  Â  Â  Â  Â  Â  connectionIndicator.color = Color.yellow;

Â  Â  Â  Â  Â  Â  Â  Â  loadingSpinner.SetActive(true);

Â  Â  Â  Â  Â  Â  Â  Â  break;

  

Â  Â  Â  Â  Â  Â  case RTDState.Connected:

Â  Â  Â  Â  Â  Â  Â  Â  statusText.text = "å·²è¿æ¥";

Â  Â  Â  Â  Â  Â  Â  Â  connectionIndicator.color = Color.green;

Â  Â  Â  Â  Â  Â  Â  Â  loadingSpinner.SetActive(false);

Â  Â  Â  Â  Â  Â  Â  Â  break;

  

Â  Â  Â  Â  Â  Â  case RTDState.SessionActive:

Â  Â  Â  Â  Â  Â  Â  Â  statusText.text = "ä¼šè¯æ´»è·ƒ";

Â  Â  Â  Â  Â  Â  Â  Â  connectionIndicator.color = Color.green;

Â  Â  Â  Â  Â  Â  Â  Â  break;

  

Â  Â  Â  Â  Â  Â  case RTDState.Error:

Â  Â  Â  Â  Â  Â  Â  Â  statusText.text = "é”™è¯¯";

Â  Â  Â  Â  Â  Â  Â  Â  connectionIndicator.color = Color.red;

Â  Â  Â  Â  Â  Â  Â  Â  loadingSpinner.SetActive(false);

Â  Â  Â  Â  Â  Â  Â  Â  break;

Â  Â  Â  Â  }

Â  Â  }

}

```

  

### 4. æ—¥å¿—ç®¡ç†

  

```csharp

public class LoggingBestPractices : MonoBehaviour

{

Â  Â  private IRealtimeDialogAPI api;

  

Â  Â  void Start()

Â  Â  {

Â  Â  Â  Â  // å¼€å‘ç¯å¢ƒå¯ç”¨è¯¦ç»†æ—¥å¿—

Â  Â  Â  Â  #if UNITY_EDITOR || DEVELOPMENT_BUILD

Â  Â  Â  Â  config.enableVerboseLogging = true;

Â  Â  Â  Â  #else

Â  Â  Â  Â  config.enableVerboseLogging = false;

Â  Â  Â  Â  #endif

  

Â  Â  Â  Â  // è®°å½•å…³é”®äº‹ä»¶

Â  Â  Â  Â  api.OnConnected += () => LogEvent("Connected");

Â  Â  Â  Â  api.OnSessionStarted += (dialogId) => LogEvent($"SessionStarted: {dialogId}");

Â  Â  Â  Â  api.OnError += (error, code) => LogError($"Error[{code}]: {error}");

Â  Â  }

  

Â  Â  void LogEvent(string message)

Â  Â  {

Â  Â  Â  Â  string timestamp = System.DateTime.Now.ToString("HH:mm:ss.fff");

Â  Â  Â  Â  Debug.Log($"[{timestamp}] {message}");

Â  Â  }

  

Â  Â  void LogError(string message)

Â  Â  {

Â  Â  Â  Â  string timestamp = System.DateTime.Now.ToString("HH:mm:ss.fff");

Â  Â  Â  Â  Debug.LogError($"[{timestamp}] {message}");

  

Â  Â  Â  Â  // å¯ä»¥å°†é”™è¯¯å‘é€åˆ°åˆ†ææœåŠ¡

Â  Â  Â  Â  // AnalyticsService.LogError(message);

Â  Â  }

}

```

  

---

  

## é™„å½•

  

### A. é…ç½®å‚æ•°å®Œæ•´è¯´æ˜

  

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |

|------|------|--------|------|

| `wsUrl` | string | wss://openspeech.bytedance.com/api/v3/realtime/dialogue | WebSocketæœåŠ¡å™¨åœ°å€ |

| `apiAppId` | string | - | ç«å±±å¼•æ“APP IDï¼ˆå¿…å¡«ï¼‰ |

| `apiAccessKey` | string | - | ç«å±±å¼•æ“Access Keyï¼ˆå¿…å¡«ï¼‰ |

| `apiAppKey` | string | PlgvMymc7f3tQnJ6 | APIåº”ç”¨Keyï¼ˆå›ºå®šå€¼ï¼‰ |

| `inputSampleRate` | int | 16000 | è¾“å…¥é‡‡æ ·ç‡ï¼ˆHzï¼‰ |

| `outputSampleRate` | int | 24000 | è¾“å‡ºé‡‡æ ·ç‡ï¼ˆHzï¼‰ |

| `channels` | int | 1 | å£°é“æ•° |

| `pcmFormat` | PcmFormat | Pcm_S16LE | PCMæ ¼å¼ |

| `defaultSpeaker` | string | zh_female_vv_jupiter_bigtts | é»˜è®¤å‘éŸ³äºº |

| `audioChunkSize` | int | 640 | éŸ³é¢‘å—å¤§å°ï¼ˆå­—èŠ‚ï¼‰ |

| `audioSendInterval` | int | 20 | å‘é€é—´éš”ï¼ˆæ¯«ç§’ï¼‰ |

| `inputMode` | InputMode | Audio | è¾“å…¥æ¨¡å¼ |

| `modelVersion` | ModelVersion | O | æ¨¡å‹ç‰ˆæœ¬ |

| `botName` | string | è±†åŒ… | æœºå™¨äººåç§° |

| `systemRole` | string | - | ç³»ç»Ÿè§’è‰²æè¿° |

| `speakingStyle` | string | - | è¯´è¯é£æ ¼ |

| `enableVerboseLogging` | bool | true | å¯ç”¨è¯¦ç»†æ—¥å¿— |

| `saveReceivedAudio` | bool | false | ä¿å­˜æ¥æ”¶çš„éŸ³é¢‘ |

  

### B. äº‹ä»¶IDå‚è€ƒ

  

#### å®¢æˆ·ç«¯äº‹ä»¶

- `1` - StartConnection

- `2` - FinishConnection

- `100` - StartSession

- `102` - FinishSession

- `200` - TaskRequest (éŸ³é¢‘ä¸Šä¼ )

- `300` - SayHello

- `500` - ChatTTSText

- `501` - ChatTextQuery

- `502` - ChatRAGText

  

#### æœåŠ¡ç«¯äº‹ä»¶

- `50` - ConnectionStarted

- `51` - ConnectionFailed

- `52` - ConnectionFinished

- `150` - SessionStarted

- `152` - SessionFinished

- `153` - SessionFailed

- `154` - UsageResponse

- `350` - TTSSentenceStart

- `351` - TTSSentenceEnd

- `352` - TTSResponse (éŸ³é¢‘æ•°æ®)

- `359` - TTSEnded

- `450` - ASRInfo

- `451` - ASRResponse

- `459` - ASREnded

- `550` - ChatResponse

- `553` - ChatTextQueryConfirmed

- `559` - ChatEnded

- `599` - DialogCommonError

  

### C. éŸ³è‰²åˆ—è¡¨

  

#### Oç‰ˆæœ¬éŸ³è‰²

- `zh_female_vv_jupiter_bigtts` - vvï¼ˆæ´»æ³¼çµåŠ¨å¥³å£°ï¼‰

- `zh_female_xiaohe_jupiter_bigtts` - xiaoheï¼ˆç”œç¾æ´»æ³¼å¥³å£°ï¼‰

- `zh_male_yunzhou_jupiter_bigtts` - yunzhouï¼ˆæ¸…çˆ½æ²‰ç¨³ç”·å£°ï¼‰

- `zh_male_xiaotian_jupiter_bigtts` - xiaotianï¼ˆæ¸…çˆ½ç£æ€§ç”·å£°ï¼‰

  

#### SCç‰ˆæœ¬éŸ³è‰²ï¼ˆå…‹éš†éŸ³è‰²ï¼‰

è¯·å‚è€ƒç«å±±å¼•æ“å®˜æ–¹æ–‡æ¡£è·å–å®Œæ•´çš„å…‹éš†éŸ³è‰²åˆ—è¡¨ã€‚

  

---

  

## æŠ€æœ¯æ”¯æŒ

  

å¦‚æœ‰é—®é¢˜ï¼Œè¯·è”ç³»ï¼š

- ç«å±±å¼•æ“å®˜æ–¹æ–‡æ¡£ï¼šhttps://www.volcengine.com/docs/

- GitHub Issuesï¼š(é¡¹ç›®åœ°å€)

- é‚®ç®±æ”¯æŒï¼š(è”ç³»é‚®ç®±)

  

---

  

**æœ€åæ›´æ–°ï¼š2025å¹´1æœˆ**

**ç‰ˆæœ¬ï¼š1.0.0**
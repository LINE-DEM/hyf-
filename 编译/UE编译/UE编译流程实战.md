# Project "Phantom Link" - UEç¼–è¯‘æµç¨‹å®Œå…¨è§£æ

## ğŸ“‹ é¡¹ç›®æ¶æ„æ¦‚è§ˆ

```
MyGame/
â”œâ”€ MyGame.uproject
â”œâ”€ Source/
â”‚   â”œâ”€ MyGame/
â”‚   â”‚   â”œâ”€ MyGame.Build.cs              # ä¸»æ¨¡å—é…ç½®
â”‚   â”‚   â”œâ”€ Public/
â”‚   â”‚   â”‚   â”œâ”€ ISkill.h                 # æŠ€èƒ½æ¥å£ï¼ˆçº¯è™šç±»ï¼‰
â”‚   â”‚   â”‚   â””â”€ SkillManager.h           # ç®¡ç†å™¨å£°æ˜
â”‚   â”‚   â””â”€ Private/
â”‚   â”‚       â”œâ”€ SkillManager.cpp         # ç®¡ç†å™¨å®ç°
â”‚   â”‚       â”œâ”€ SkillRegistrar.h         # è‡ªæ³¨å†Œè¾…åŠ©ç±»
â”‚   â”‚       â”œâ”€ Skill_Fireball.cpp       # ç«çƒæœ¯å®ç°ï¼ˆè‡ªæ³¨å†Œï¼‰
â”‚   â”‚       â”œâ”€ Skill_IceShard.cpp       # å†°éœœç¢ç‰‡ï¼ˆè‡ªæ³¨å†Œï¼‰
â”‚   â”‚       â””â”€ MyGameGameMode.cpp       # æ¸¸æˆæ¨¡å¼
â”‚   â””â”€ MyGame.Target.cs                 # æ„å»ºç›®æ ‡é…ç½®
â””â”€ Intermediate/                        # ç¼–è¯‘ä¸­é—´äº§ç‰©
    â””â”€ Build/
        â””â”€ Win64/
            â””â”€ UE5Editor/
                â””â”€ Inc/MyGame/          # ç”Ÿæˆçš„å¤´æ–‡ä»¶
```

---

## ğŸ”§ é˜¶æ®µ 0: Build.cs é…ç½®å±‚ï¼ˆUBT è§£ææœŸï¼‰

### MyGame.Build.cs é…ç½®

```csharp
using UnrealBuildTool;

public class MyGame : ModuleRules
{
    public MyGame(ReadOnlyTargetRules Target) : base(Target)
    {
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // 1. PCH ç­–ç•¥ï¼šå½±å“ç¼–è¯‘é€Ÿåº¦çš„å…³é”®
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        PCHUsage = PCHUsageMode.UseExplicitOrSharedPCHs;
        // è½¬åŒ–ä¸ºï¼šcl.exe /Yu"MyGame.h" /Fp"Intermediate/Build/.../MyGame.pch"
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // 2. å…¬å…±ä¾èµ–ï¼šå†³å®šé“¾æ¥ä»€ä¹ˆ + æš´éœ²ä»€ä¹ˆå¤´æ–‡ä»¶
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        PublicDependencyModuleNames.AddRange(new string[] {
            "Core",           // â†’ link.exe UE5Editor-Core.lib
            "CoreUObject",    // â†’ link.exe UE5Editor-CoreUObject.lib
            "Engine"          // â†’ link.exe UE5Editor-Engine.lib
        });
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // 3. ç§æœ‰ä¾èµ–ï¼šåªåœ¨ .cpp ä¸­å¯è§
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        PrivateDependencyModuleNames.AddRange(new string[] {
            "Slate",
            "SlateCore"
        });
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // 4. é¢„å¤„ç†å™¨å®ï¼šæ¡ä»¶ç¼–è¯‘æ§åˆ¶
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        if (Target.Configuration != UnrealTargetConfiguration.Shipping)
        {
            PublicDefinitions.Add("SKILL_DEBUG_MODE=1");
            // è½¬åŒ–ä¸ºï¼šcl.exe /D "SKILL_DEBUG_MODE=1"
        }
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // 5. ä¼˜åŒ–æ§åˆ¶ï¼šå…³é”®æ¨¡å—å¯ä»¥ç‰¹æ®Šå¤„ç†
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // OptimizeCode = CodeOptimization.Never; // ç¦ç”¨ä¼˜åŒ–ä»¥ä¾¿è°ƒè¯•
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // 6. è¿è¡Œæ—¶ç±»å‹ä¿¡æ¯ï¼šè™šå‡½æ•°è¡¨éœ€è¦
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        bUseRTTI = true; // é»˜è®¤å¼€å¯ï¼Œç¡®ä¿ dynamic_cast å¯ç”¨
    }
}
```

### UBT (UnrealBuildTool) çš„å·¥ä½œæµç¨‹

```
ç”¨æˆ·æ‰§è¡Œï¼šå³é”® .uproject â†’ "Generate Visual Studio Project Files"
    â†“
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
UBT å¯åŠ¨ï¼šEngine/Binaries/DotNET/UnrealBuildTool.exe
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    â†“
1. è§£æ .uproject æ–‡ä»¶
   - è¯»å–æ¨¡å—åˆ—è¡¨ï¼š["MyGame"]
   - è¯»å–æ’ä»¶å¼•ç”¨
    â†“
2. æ‰§è¡Œ MyGame.Build.cs
   - å®ä¾‹åŒ– MyGame ç±»
   - æ”¶é›†ä¾èµ–æ ‘ï¼š
     MyGame â†’ Core, CoreUObject, Engine â†’ é€’å½’è§£æå®ƒä»¬çš„ä¾èµ–
    â†“
3. ç”Ÿæˆç¼–è¯‘å‘½ä»¤
   ä¸ºæ¯ä¸ª .cpp æ–‡ä»¶ç”Ÿæˆå®Œæ•´çš„ cl.exe å‘½ä»¤è¡Œ
    â†“
4. è¾“å‡ºç»“æœ
   - ç”Ÿæˆ .sln å’Œ .vcxproj æ–‡ä»¶
   - ç”Ÿæˆ Makefile (ç”¨äºå¢é‡ç¼–è¯‘åˆ¤æ–­)
   - å†™å…¥ .response æ–‡ä»¶ï¼ˆå‘½ä»¤è¡Œå¤ªé•¿æ—¶ç”¨ï¼‰
```

---

## ğŸ—ï¸ é˜¶æ®µ 1: ç¼–è¯‘å‡†å¤‡ï¼ˆVS å¯åŠ¨æœŸï¼‰

### é¡¹ç›®ä¾èµ–å›¾ç”Ÿæˆ

```
MyGame.vcxproj çš„ä¾èµ–å…³ç³»ï¼š
    â†“
ä¾èµ–äºï¼šUE5Editor-Core.lib (æ¥è‡ª Engine/Binaries/Win64/)
ä¾èµ–äºï¼šUE5Editor-CoreUObject.lib
ä¾èµ–äºï¼šUE5Editor-Engine.lib
ä¾èµ–äºï¼šUE5Editor-Slate.lib (Privateä¾èµ–ï¼Œé“¾æ¥ä½†ä¸æš´éœ²)
    â†“
è¿™äº› .lib éƒ½æ˜¯ **å¯¼å…¥åº“ (Import Library)**
    - ä¸åŒ…å«å®é™…ä»£ç 
    - åªåŒ…å«ç¬¦å·è¡¨ï¼šå‘Šè¯‰é“¾æ¥å™¨"è¿™ä¸ªå‡½æ•°åœ¨ UE5Editor-Core.dll ä¸­"
```

### UE æ¨¡å—çš„äºŒè¿›åˆ¶ç±»å‹

|æ¨¡å—ç±»å‹|è¾“å‡ºæ–‡ä»¶|å¯¼å…¥åº“|ä½•æ—¶ç”Ÿæˆ|
|---|---|---|---|
|**å¼•æ“æ¨¡å—**<br>(Core, Engineç­‰)|`UE5Editor-Core.dll`|`UE5Editor-Core.lib`|å¼•æ“ç¼–è¯‘æ—¶<br>(é¢„ç¼–è¯‘å¥½çš„)|
|**æ¸¸æˆæ¨¡å—**<br>(MyGame)|`UE5Editor-MyGame.dll`|`UE5Editor-MyGame.lib`|**æœ¬æ¬¡ç¼–è¯‘ç”Ÿæˆ**|
|**é™æ€é“¾æ¥åº“**<br>(ç¬¬ä¸‰æ–¹åº“)|æ—  DLL|`ThirdParty.lib`|ç¬¬ä¸‰æ–¹æä¾›|

**å…³é”®è®¤çŸ¥**ï¼š

- UE çš„æ¸¸æˆæ¨¡å—æœ€ç»ˆç¼–è¯‘æˆ **DLL**ï¼Œè€Œä¸æ˜¯é™æ€åº“ï¼
- è¿™æ˜¯ä¸ºäº†æ”¯æŒ**çƒ­é‡è½½ (Live Coding)**ï¼šä¿®æ”¹ä»£ç åï¼Œå¸è½½æ—§ DLLï¼ŒåŠ è½½æ–° DLL
- ä½†åœ¨ç¼–è¯‘é“¾æ¥è¿‡ç¨‹ä¸­ï¼Œä¼šå…ˆç”Ÿæˆ `.lib`ï¼ˆå¯¼å…¥åº“ï¼‰ä¾›å…¶ä»–æ¨¡å—å¼•ç”¨

---

## âš™ï¸ é˜¶æ®µ 2: ç¼–è¯‘ ISkill.hï¼ˆæ¥å£å®šä¹‰ï¼‰

### æ–‡ä»¶å†…å®¹

```cpp
// ISkill.h (ä½äº Public/ ç›®å½•)
#pragma once
#include "CoreMinimal.h"  // UE çš„æ ¸å¿ƒå¤´æ–‡ä»¶

class ISkill {
public:
    virtual ~ISkill() {} 
    virtual void Execute(AActor* Caster) = 0; 
    virtual FString GetName() = 0;
};
```

### ç¼–è¯‘å™¨å¤„ç†

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
å½“ SkillManager.cpp åŒ…å«è¿™ä¸ªå¤´æ–‡ä»¶æ—¶
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    â†“
é¢„å¤„ç†å™¨å±•å¼€ (cl.exe /E)ï¼š
    #include "CoreMinimal.h" 
    â†’ å±•å¼€æˆå‡ åƒè¡Œä»£ç  (AActor, FString ç­‰å®šä¹‰)
    â†“
    #pragma once
    â†’ è®°å½•åˆ°ç¼–è¯‘å™¨å†…å­˜ï¼šISkill.h å·²å¤„ç†
    â†“
    class ISkill { ... }
    â†’ è§£æä¸ºç±»å‹å®šä¹‰ï¼Œå­˜å…¥ç¬¦å·è¡¨
    â†“
ç¼–è¯‘å™¨ç”Ÿæˆçš„é‡è¦ä¿¡æ¯ï¼š
    - VTable å¸ƒå±€ï¼ˆè™šå‡½æ•°è¡¨ç»“æ„ï¼‰ï¼š
      [0] ~ISkill()
      [1] Execute()
      [2] GetName()
    - ç±»å‹ä¿¡æ¯ï¼ˆRTTIï¼‰ï¼šå­˜å‚¨ç±»åã€ç»§æ‰¿å…³ç³»
    â†“
ä½†è¿™ä¸ªå¤´æ–‡ä»¶æœ¬èº« **ä¸ä¼šç”Ÿæˆ .obj æ–‡ä»¶**
    â†’ å®ƒåªæ˜¯ç±»å‹å£°æ˜ï¼Œæ²¡æœ‰å®ç°ä»£ç 
```

---

## ğŸ”¨ é˜¶æ®µ 3: ç¼–è¯‘ SkillManager.cpp

### æ–‡ä»¶å†…å®¹

```cpp
// SkillManager.cpp
#include "SkillManager.h"
#include "ISkill.h"

FSkillManager& FSkillManager::Get() {
    static FSkillManager Instance; // å•ä¾‹
    return Instance;
}

void FSkillManager::RegisterSkill(FString Name, SkillSpawner Spawner) {
    SkillRegistry.Add(Name, Spawner);
    UE_LOG(LogTemp, Log, TEXT("âœ“ Skill Registered: %s"), *Name);
}

void FSkillManager::CastSkill(FString Name, AActor* Caster) {
    if (SkillSpawner* Spawner = SkillRegistry.Find(Name)) {
        ISkill* Skill = (*Spawner)(); // è°ƒç”¨å·¥å‚å‡½æ•°
        Skill->Execute(Caster);       // å¤šæ€è°ƒç”¨ï¼
        delete Skill;
    }
}
```

### ç¼–è¯‘å‘½ä»¤ç”Ÿæˆ

UBT ç”Ÿæˆçš„å®é™…å‘½ä»¤ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š

```bash
cl.exe 
    /c                                      # åªç¼–è¯‘ä¸é“¾æ¥
    /Yu"MyGame.h"                           # ä½¿ç”¨ PCH
    /Fp"Intermediate/.../MyGame.pch"        # PCH æ–‡ä»¶è·¯å¾„
    /Fo"Intermediate/.../SkillManager.obj"  # è¾“å‡ºç›®æ ‡æ–‡ä»¶
    /I"Source/MyGame/Public"                # åŒ…å«è·¯å¾„ï¼šè‡ªå·±çš„ Public
    /I"Engine/Source/Runtime/Core/Public"   # Core çš„å¤´æ–‡ä»¶
    /I"Engine/Source/Runtime/Engine/Public" # Engine çš„å¤´æ–‡ä»¶
    /D "SKILL_DEBUG_MODE=1"                 # å®å®šä¹‰ï¼ˆæ¥è‡ª Build.csï¼‰
    /W3                                     # è­¦å‘Šçº§åˆ«
    /Zi                                     # ç”Ÿæˆè°ƒè¯•ä¿¡æ¯
    /MDd                                    # è¿è¡Œæ—¶åº“ï¼šå¤šçº¿ç¨‹è°ƒè¯• DLL
    /EHsc                                   # å¼‚å¸¸å¤„ç†
    /GR                                     # å¯ç”¨ RTTIï¼ˆè™šå‡½æ•°è¡¨éœ€è¦ï¼‰
    SkillManager.cpp
```

### ç”Ÿæˆçš„ .obj æ–‡ä»¶å†…å®¹

```
SkillManager.obj çš„ç»“æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¦å·è¡¨ï¼ˆSymbol Tableï¼‰                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FSkillManager::Get()         [å®šä¹‰]          â”‚
â”‚ FSkillManager::RegisterSkill [å®šä¹‰]          â”‚
â”‚ FSkillManager::CastSkill     [å®šä¹‰]          â”‚
â”‚                                              â”‚
â”‚ ISkill::Execute()            [æœªå®šä¹‰å¼•ç”¨]    â”‚
â”‚ AActor::GetName()            [æœªå®šä¹‰å¼•ç”¨]    â”‚
â”‚ FString::operator*()         [æœªå®šä¹‰å¼•ç”¨]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æœºå™¨ç æ®µï¼ˆ.textï¼‰                             â”‚
â”‚ - Get() çš„æ±‡ç¼–ä»£ç                            â”‚
â”‚ - RegisterSkill() çš„æ±‡ç¼–ä»£ç                  â”‚
â”‚ - CastSkill() ä¸­çš„è™šå‡½æ•°è°ƒç”¨è·³æ¿             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ•°æ®æ®µï¼ˆ.dataï¼‰                               â”‚
â”‚ - é™æ€å˜é‡ Instance çš„å­˜å‚¨ç©ºé—´               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é‡å®šä½è¡¨ï¼ˆRelocation Tableï¼‰                 â”‚
â”‚ - "ISkill::Execute" çš„åœ°å€å¾…å¡«å……             â”‚
â”‚ - "UE_LOG å®" å±•å¼€çš„å‡½æ•°è°ƒç”¨åœ°å€å¾…å¡«å……       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”¥ é˜¶æ®µ 4: ç¼–è¯‘ Skill_Fireball.cppï¼ˆè‡ªæ³¨å†Œé­”æ³•ï¼‰

### æ–‡ä»¶å†…å®¹

```cpp
// Skill_Fireball.cpp (ä½äº Private/ ç›®å½•)
#include "ISkill.h"
#include "SkillRegistrar.h"

// 1. å…·ä½“ç­–ç•¥å®ç°
class FFireballSkill : public ISkill {
public:
    virtual void Execute(AActor* Caster) override {
        UE_LOG(LogTemp, Warning, TEXT("ğŸ”¥ CASTING FIREBALL!"));
    }
    virtual FString GetName() override { return "Fireball"; }
};

// 2. ã€å…³é”®ã€‘Pre-Main è‡ªæ³¨å†Œæœºåˆ¶
static FSkillRegistrar FireballRegistrar(
    "Fireball", 
    []() -> ISkill* { return new FFireballSkill(); }
);
```

### ç¼–è¯‘å™¨å¦‚ä½•å¤„ç†é™æ€å˜é‡

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
cl.exe ç¼–è¯‘ Skill_Fireball.cpp
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    â†“
1. è§£æç±»å®šä¹‰ï¼š
   FFireballSkill ç»§æ‰¿ ISkill
   â†’ ç¼–è¯‘å™¨ç”Ÿæˆè™šå‡½æ•°è¡¨ï¼š
   
   FFireballSkill çš„ VTableï¼š
   [0] FFireballSkill::~FFireballSkill()
   [1] FFireballSkill::Execute()      â† è¦†ç›–äº† ISkill::Execute
   [2] FFireballSkill::GetName()       â† è¦†ç›–äº† ISkill::GetName
    â†“
2. é‡åˆ°é™æ€å˜é‡å£°æ˜ï¼š
   static FSkillRegistrar FireballRegistrar(...);
   
   ç¼–è¯‘å™¨çš„è¡Œä¸ºï¼š
   â‘  ä¸ºè¿™ä¸ªå˜é‡åˆ†é…é™æ€å­˜å‚¨åŒºï¼ˆ.data æ®µï¼‰
   â‘¡ ç”Ÿæˆ **åˆå§‹åŒ–å‡½æ•°**ï¼ˆé€šå¸¸å‘½åä¸º `_GLOBAL__sub_I_xxx`ï¼‰
   â‘¢ å°†åˆå§‹åŒ–å‡½æ•°çš„åœ°å€æ³¨å†Œåˆ° **CRT åˆå§‹åŒ–è¡¨**
    â†“
3. ç”Ÿæˆçš„ä¼ªä»£ç ï¼ˆç¼–è¯‘å™¨å†…éƒ¨é€»è¾‘ï¼‰ï¼š
   
   void _GLOBAL__sub_I_Skill_Fireball() {
       // è¿™ä¸ªå‡½æ•°ä¼šåœ¨ main() ä¹‹å‰è¢«è°ƒç”¨ï¼
       new (&FireballRegistrar) FSkillRegistrar(
           "Fireball",
           []() -> ISkill* { return new FFireballSkill(); }
       );
   }
   
   // æ³¨å†Œåˆ° CRT åˆå§‹åŒ–è¡¨
   __declspec(allocate(".CRT$XCU")) 
   void (*_Init_FireballRegistrar)() = _GLOBAL__sub_I_Skill_Fireball;
    â†“
4. è¾“å‡ºæ–‡ä»¶ï¼š
   Skill_Fireball.obj
```

### Skill_Fireball.obj çš„ç‰¹æ®Šç»“æ„

```
Skill_Fireball.objï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¦å·è¡¨                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FFireballSkill::Execute()    [å®šä¹‰]          â”‚
â”‚ FFireballSkill::GetName()    [å®šä¹‰]          â”‚
â”‚ FireballRegistrar            [é™æ€å˜é‡]      â”‚
â”‚ _GLOBAL__sub_I_xxx           [åˆå§‹åŒ–å‡½æ•°]    â”‚
â”‚                                              â”‚
â”‚ FSkillRegistrar::æ„é€ å‡½æ•°    [æœªå®šä¹‰å¼•ç”¨]    â”‚
â”‚ SkillManager::RegisterSkill  [æœªå®šä¹‰å¼•ç”¨]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ .text æ®µï¼ˆä»£ç ï¼‰                             â”‚
â”‚ - FFireballSkill::Execute çš„æœºå™¨ç            â”‚
â”‚ - Lambda è¡¨è¾¾å¼çš„æœºå™¨ç                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ .data æ®µï¼ˆæ•°æ®ï¼‰                             â”‚
â”‚ - FireballRegistrar çš„å­˜å‚¨ç©ºé—´ï¼ˆ8å­—èŠ‚ï¼‰      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ .CRT$XCU æ®µï¼ˆCRT åˆå§‹åŒ–è¡¨ï¼‰â­                 â”‚
â”‚ - å‡½æ•°æŒ‡é’ˆï¼š_GLOBAL__sub_I_xxx               â”‚
â”‚   è¿™ä¸ªæ®µä¼šåœ¨è¿è¡Œæ—¶è¢«ç‰¹æ®Šå¤„ç†ï¼                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ VTable æ•°æ®                                  â”‚
â”‚ FFireballSkill çš„è™šå‡½æ•°è¡¨ï¼š                  â”‚
â”‚   [0] ææ„å‡½æ•°åœ°å€                           â”‚
â”‚   [1] Execute çš„åœ°å€                         â”‚
â”‚   [2] GetName çš„åœ°å€                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”— é˜¶æ®µ 5: é“¾æ¥é˜¶æ®µï¼ˆç”Ÿæˆ DLLï¼‰

### é“¾æ¥å™¨è°ƒç”¨

```bash
link.exe 
    /DLL                                    # ç”Ÿæˆ DLL è€Œé EXE
    /OUT:"Binaries/Win64/UE5Editor-MyGame.dll"
    /IMPLIB:"Intermediate/.../MyGame.lib"   # åŒæ—¶ç”Ÿæˆå¯¼å…¥åº“
    /LIBPATH:"Engine/Binaries/Win64"        # æœç´¢ UE çš„å¯¼å…¥åº“
    /PDB:"Binaries/Win64/UE5Editor-MyGame.pdb"
    
    # è¾“å…¥çš„ .obj æ–‡ä»¶ï¼ˆæ¥è‡ªç¼–è¯‘é˜¶æ®µï¼‰
    Intermediate/.../SkillManager.obj
    Intermediate/.../Skill_Fireball.obj
    Intermediate/.../Skill_IceShard.obj
    Intermediate/.../MyGameGameMode.obj
    
    # å¼•ç”¨çš„å¯¼å…¥åº“ï¼ˆæ¥è‡ª Build.cs çš„ä¾èµ–å£°æ˜ï¼‰
    UE5Editor-Core.lib
    UE5Editor-CoreUObject.lib
    UE5Editor-Engine.lib
    UE5Editor-Slate.lib
    
    /DEBUG                                   # ç”Ÿæˆè°ƒè¯•ä¿¡æ¯
    /INCREMENTAL                             # å¢é‡é“¾æ¥
```

### é“¾æ¥å™¨çš„å·¥ä½œæµç¨‹

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
A. ç¬¦å·è§£æé˜¶æ®µ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
é“¾æ¥å™¨æ‰«ææ‰€æœ‰ .obj å’Œ .libï¼š

SkillManager.obj éœ€è¦çš„ç¬¦å·ï¼š
  âœ“ FSkillManager::Get()       â†’ åœ¨æœ¬ obj ä¸­å®šä¹‰
  âœ— ISkill::Execute()          â†’ è™šå‡½æ•°ï¼Œä¸éœ€è¦å…·ä½“å®ç°ï¼ˆçº¯è™šï¼‰
  âœ— UE_LOG ç›¸å…³å‡½æ•°            â†’ åœ¨ UE5Editor-Core.lib ä¸­æ‰¾åˆ°

Skill_Fireball.obj éœ€è¦çš„ç¬¦å·ï¼š
  âœ“ FFireballSkill::Execute()  â†’ åœ¨æœ¬ obj ä¸­å®šä¹‰
  âœ— FSkillRegistrar::æ„é€ å‡½æ•°  â†’ å†…è”å‡½æ•°ï¼Œå·²å±•å¼€
  âœ— SkillManager::RegisterSkill â†’ åœ¨ SkillManager.obj ä¸­æ‰¾åˆ°âœ“

æ‰€æœ‰ç¬¦å·è§£æå®Œæ¯•ï¼æ²¡æœ‰æœªå®šä¹‰å¼•ç”¨ (Unresolved External)
    â†“
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
B. åœ°å€åˆ†é…é˜¶æ®µï¼ˆç”Ÿæˆ DLL çš„å†…å­˜å¸ƒå±€ï¼‰
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
é“¾æ¥å™¨æ„å»º DLL çš„è™šæ‹Ÿå†…å­˜æ˜ åƒï¼š

åŸºå€ï¼š0x10000000 (DLL çš„é»˜è®¤åŠ è½½åœ°å€)
    â†“
.text æ®µï¼ˆä»£ç æ®µï¼‰ï¼š
  0x10001000: SkillManager::Get()
  0x10001100: SkillManager::RegisterSkill()
  0x10001200: SkillManager::CastSkill()
  0x10002000: FFireballSkill::Execute()
  0x10002100: FFireballSkill çš„ Lambda å·¥å‚å‡½æ•°
  0x10003000: FIceShardSkill::Execute()
    â†“
.data æ®µï¼ˆå·²åˆå§‹åŒ–æ•°æ®ï¼‰ï¼š
  0x10101000: SkillManager çš„é™æ€å®ä¾‹
  0x10101100: FireballRegistrar é™æ€å˜é‡
  0x10101110: IceShardRegistrar é™æ€å˜é‡
    â†“
.rdata æ®µï¼ˆåªè¯»æ•°æ®ï¼‰ï¼š
  0x10201000: FFireballSkill çš„ VTable
    [0] â†’ 0x10002000 (Execute)
    [1] â†’ 0x10002050 (GetName)
  0x10201020: FIceShardSkill çš„ VTable
    â†“
.CRT$XCU æ®µï¼ˆåˆå§‹åŒ–å‡½æ•°è¡¨ï¼‰â­ï¼š
  0x10301000: _GLOBAL__sub_I_Fireball çš„åœ°å€
  0x10301008: _GLOBAL__sub_I_IceShard çš„åœ°å€
  â†’ è¿™ä¸ªæ®µä¼šè¢« Windows åŠ è½½å™¨ç‰¹æ®Šè¯†åˆ«ï¼
    â†“
.idata æ®µï¼ˆå¯¼å…¥è¡¨ï¼‰ï¼š
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ DLLåç§°: UE5Editor-Core.dll        â”‚
  â”‚ Import Address Table (IAT):       â”‚
  â”‚   [0] UE_LOG ç›¸å…³å‡½æ•°              â”‚
  â”‚   [1] FString æ„é€ å‡½æ•°             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ DLLåç§°: UE5Editor-Engine.dll      â”‚
  â”‚ IAT:                              â”‚
  â”‚   [0] AActor::GetName()            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
.edata æ®µï¼ˆå¯¼å‡ºè¡¨ï¼‰ï¼š
  æˆ‘ä»¬çš„ DLL å¯¼å‡ºçš„ç¬¦å·ï¼ˆä¾›å…¶ä»–æ¨¡å—å¼•ç”¨ï¼‰ï¼š
  - FSkillManager::Get
  - FSkillManager::RegisterSkill
  - FSkillManager::CastSkill
    â†“
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
C. é‡å®šä½å¤„ç†
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ä¿®æ­£ä»£ç ä¸­çš„åœ°å€å¼•ç”¨ï¼š

SkillManager::CastSkill() ä¸­çš„ä»£ç ï¼š
åŸå§‹ï¼š
  call [å¾…å¡«å……]              ; è°ƒç”¨ Skill->Execute()
  
é“¾æ¥åï¼š
  mov rax, [rcx]             ; è¯»å–å¯¹è±¡çš„ vptr
  call qword ptr [rax+8]     ; è°ƒç”¨ vtable[1]ï¼Œå³ Execute()
  
è¿™é‡Œæ²¡æœ‰ç¡¬ç¼–ç åœ°å€ï¼Œè€Œæ˜¯é€šè¿‡ VTable é—´æ¥è°ƒç”¨ï¼âœ“
    â†“
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
D. ç”Ÿæˆæœ€ç»ˆæ–‡ä»¶
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
è¾“å‡ºï¼š
1. UE5Editor-MyGame.dll        (å®é™…ä»£ç å’Œæ•°æ®)
2. UE5Editor-MyGame.lib        (å¯¼å…¥åº“ï¼Œç»™å…¶ä»–æ¨¡å—é“¾æ¥ç”¨)
3. UE5Editor-MyGame.pdb        (è°ƒè¯•ç¬¦å·)
```

### å¯¼å…¥åº“çš„å†…å®¹

```
UE5Editor-MyGame.lib çš„ç»“æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¦å·ç´¢å¼•ï¼ˆSymbol Indexï¼‰                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FSkillManager::Get                           â”‚
â”‚   â†’ DLLåç§°: UE5Editor-MyGame.dll            â”‚
â”‚   â†’ å¯¼å‡ºåºå·: 1                              â”‚
â”‚                                              â”‚
â”‚ FSkillManager::RegisterSkill                 â”‚
â”‚   â†’ DLLåç§°: UE5Editor-MyGame.dll            â”‚
â”‚   â†’ å¯¼å‡ºåºå·: 2                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è¿™ä¸ª .lib ä¸åŒ…å«ä»»ä½•æœºå™¨ç ï¼
å®ƒåªæ˜¯å‘Šè¯‰é“¾æ¥å™¨ï¼š"è¿™äº›ç¬¦å·åœ¨è¿è¡Œæ—¶ä» DLL ä¸­æŸ¥æ‰¾"
```

---

## ğŸš€ é˜¶æ®µ 6: è¿è¡Œæ—¶åŠ è½½ï¼ˆPre-Main é­”æ³•æ­ç§˜ï¼‰

### UE Editor å¯åŠ¨æµç¨‹

```
ç”¨æˆ·ç‚¹å‡» "Play" æˆ–å¯åŠ¨ç¼–è¾‘å™¨
    â†“
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Windows åŠ è½½å™¨å¯åŠ¨ UE5Editor.exe
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    â†“
1. åŠ è½½ UE5Editor.exe åˆ°å†…å­˜
    â†“
2. è§£æå¯¼å…¥è¡¨ï¼Œä¾æ¬¡åŠ è½½ä¾èµ–çš„ DLLï¼š
   - UE5Editor-Core.dll
   - UE5Editor-CoreUObject.dll
   - UE5Editor-Engine.dll
   - ... (å‡ åä¸ªå¼•æ“æ¨¡å—)
    â†“
3. ã€å…³é”®ã€‘åŠ è½½æ¸¸æˆæ¨¡å— DLLï¼š
   LoadLibrary("Binaries/Win64/UE5Editor-MyGame.dll")
    â†“
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Windows åŠ è½½ UE5Editor-MyGame.dll
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    â†“
3.1 å°† DLL æ˜ å°„åˆ°è¿›ç¨‹åœ°å€ç©ºé—´ï¼ˆå‡è®¾åŸºå€ 0x180000000ï¼‰
    â†“
3.2 å¡«å……å¯¼å…¥åœ°å€è¡¨ï¼ˆIATï¼‰ï¼š
    MyGame çš„ IAT ä¸­ï¼š
    [UE_LOG çš„æ§½ä½] â†’ å¡«å……ä¸º Core.dll ä¸­çš„å®é™…åœ°å€
    [AActor::GetName çš„æ§½ä½] â†’ å¡«å……ä¸º Engine.dll ä¸­çš„å®é™…åœ°å€
    â†“
3.3 ã€Pre-Main é­”æ³•ã€‘æ‰§è¡Œ CRT åˆå§‹åŒ–å™¨ï¼š
    Windows åŠ è½½å™¨æŸ¥æ‰¾ DLL ä¸­çš„ .CRT$XCU æ®µ
    
    å‘ç°åˆå§‹åŒ–å‡½æ•°åˆ—è¡¨ï¼š
    [0] _GLOBAL__sub_I_Skill_Fireball
    [1] _GLOBAL__sub_I_Skill_IceShard
    
    æŒ‰é¡ºåºè°ƒç”¨è¿™äº›å‡½æ•°ï¼š
    
    â†’ è°ƒç”¨ _GLOBAL__sub_I_Skill_Fireball()
      {
          // æ„é€  FireballRegistrar é™æ€å˜é‡
          new (&FireballRegistrar) FSkillRegistrar(
              "Fireball",
              []() { return new FFireballSkill(); }
          );
          // FSkillRegistrar çš„æ„é€ å‡½æ•°ä¼šè°ƒç”¨ï¼š
          FSkillManager::Get().RegisterSkill("Fireball", ...);
      }
      
    âœ“ æ­¤æ—¶ SkillManager çš„ Map ä¸­å·²ç»æœ‰äº† "Fireball"ï¼
    
    â†’ è°ƒç”¨ _GLOBAL__sub_I_Skill_IceShard()
      {
          // åŒæ ·çš„è¿‡ç¨‹ï¼Œæ³¨å†Œ IceShard
      }
      
    âœ“ Map ä¸­ç°åœ¨æœ‰ï¼š["Fireball", "IceShard"]
    â†“
3.4 æ‰§è¡Œ DLL çš„ DllMainï¼ˆå¦‚æœæœ‰ï¼‰
    â†“
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
DLL åŠ è½½å®Œæˆï¼Œæ§åˆ¶æƒè¿”å› UE5Editor.exe çš„ main()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    â†“
4. UE åˆå§‹åŒ–å¼•æ“ç³»ç»Ÿ
    â†“
5. åˆ›å»º GameModeï¼Œè°ƒç”¨ BeginPlay()
```

### BeginPlay ä¸­çš„è°ƒç”¨é“¾

```cpp
void AMyGameGameMode::BeginPlay()
{
    Super::BeginPlay();
    
    // æ­¤æ—¶ï¼ŒæŠ€èƒ½å·²ç»å…¨éƒ¨æ³¨å†Œå®Œæ¯•ï¼
    FSkillManager::Get().CastSkill("Fireball", this);
}
```

**è¿è¡Œæ—¶çš„å®é™…æ‰§è¡Œ**ï¼š

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
CastSkill("Fireball", this) çš„æ‰§è¡Œæµç¨‹
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    â†“
1. åœ¨ Map ä¸­æŸ¥æ‰¾ "Fireball"
   â†’ æ‰¾åˆ° Lambda: []() { return new FFireballSkill(); }
    â†“
2. è°ƒç”¨ Lambdaï¼ˆå·¥å‚å‡½æ•°ï¼‰
   â†’ åœ¨å †ä¸Šåˆ†é… FFireballSkill å¯¹è±¡
   â†’ å¯¹è±¡çš„å‰8å­—èŠ‚ï¼ˆvptrï¼‰æŒ‡å‘ FFireballSkill çš„ VTable
    â†“
3. è°ƒç”¨ Skill->Execute(Caster)
   CPU æ‰§è¡Œçš„æ±‡ç¼–ï¼ˆä¼ªä»£ç ï¼‰ï¼š
   
   mov rax, [Skill]           ; rax = å¯¹è±¡åœ°å€
   mov rax, [rax]             ; rax = vptrï¼ˆè¯»å–å¯¹è±¡å‰8å­—èŠ‚ï¼‰
   call qword ptr [rax+8]     ; è·³è½¬åˆ° vtable[1]ï¼Œå³ Execute
   
   vtable[1] å­˜å‚¨çš„åœ°å€æ˜¯ï¼š0x10002000
   â†’ è¿™æ­£æ˜¯ FFireballSkill::Execute() çš„åœ°å€ï¼
    â†“
4. æ‰§è¡Œ FFireballSkill::Execute() çš„ä»£ç 
   æ‰“å°ï¼šğŸ”¥ CASTING FIREBALL!
    â†“
5. delete Skill
   â†’ è°ƒç”¨ææ„å‡½æ•°ï¼Œé‡Šæ”¾å†…å­˜
```

---

## ğŸ“Š å®Œæ•´æµç¨‹æ—¶åºå›¾

```
æ—¶é—´çº¿ï¼šä» Build.cs åˆ°è¿è¡Œæ—¶è°ƒç”¨

T0: å¼€å‘é˜¶æ®µ
  â”‚ ç¨‹åºå‘˜ç¼–å†™ Build.csã€ISkill.hã€Skill_Fireball.cpp
  â”‚
T1: æ‰§è¡Œ "Generate VS Files"
  â”‚ UBT è§£æ Build.cs
  â”‚ ç”Ÿæˆ .vcxproj å’Œç¼–è¯‘å‘½ä»¤
  â”‚
T2: æ‰§è¡Œ "Build Solution"
  â”‚ cl.exe ç¼–è¯‘ SkillManager.cpp      â†’ SkillManager.obj
  â”‚ cl.exe ç¼–è¯‘ Skill_Fireball.cpp    â†’ Skill_Fireball.obj (å¸¦ .CRT$XCU æ®µ)
  â”‚ cl.exe ç¼–è¯‘ Skill_IceShard.cpp    â†’ Skill_IceShard.obj (å¸¦ .CRT$XCU æ®µ)
  â”‚
T3: é“¾æ¥é˜¶æ®µ
  â”‚ link.exe åˆå¹¶æ‰€æœ‰ .obj
  â”‚ ç”Ÿæˆ UE5Editor-MyGame.dll         (åŒ…å«æ‰€æœ‰ä»£ç )
  â”‚ ç”Ÿæˆ UE5Editor-MyGame.lib         (å¯¼å…¥åº“)
  â”‚
T4: å¯åŠ¨ç¼–è¾‘å™¨
  â”‚ Windows åŠ è½½ UE5Editor.exe
  â”‚ åŠ è½½æ‰€æœ‰å¼•æ“ DLL
  â”‚ åŠ è½½ UE5Editor-MyGame.dll
  â”‚     â†“
  â”‚     æ‰§è¡Œ .CRT$XCU æ®µçš„åˆå§‹åŒ–å‡½æ•°
  â”‚     â†’ FireballRegistrar æ„é€ 
  â”‚     â†’ IceShardRegistrar æ„é€ 
  â”‚     âœ“ æŠ€èƒ½æ³¨å†Œå®Œæˆï¼ˆåœ¨ main() ä¹‹å‰ï¼ï¼‰
  â”‚
T5: è¿è¡Œ GameMode::BeginPlay()
  â”‚ è°ƒç”¨ SkillManager::CastSkill("Fireball", ...)
  â”‚     â†“
  â”‚     æŸ¥æ‰¾ Map â†’ æ‰¾åˆ° Lambda
  â”‚     â†“
  â”‚     è°ƒç”¨ Lambda â†’ new FFireballSkill
  â”‚     â†“
  â”‚     è™šå‡½æ•°è°ƒç”¨ â†’ Execute()
  â”‚     â†“
  â”‚     æ‰“å°æ—¥å¿—ï¼šğŸ”¥ CASTING FIREBALL!
  â”‚
T6: çƒ­é‡è½½ï¼ˆLive Codingï¼‰
  â”‚ ç¨‹åºå‘˜ä¿®æ”¹ Skill_Fireball.cpp
  â”‚ UE æ£€æµ‹åˆ°å˜åŒ–
  â”‚     â†“
  â”‚     é‡æ–°ç¼–è¯‘ Skill_Fireball.cpp
  â”‚     â†“
  â”‚     link.exe ç”Ÿæˆæ–°çš„ UE5Editor-MyGame.dll
  â”‚     â†“
  â”‚     FreeLibrary(æ—§DLL)
  â”‚     LoadLibrary(æ–°DLL)
  â”‚     â†“
  â”‚     å†æ¬¡æ‰§è¡Œ .CRT$XCU åˆå§‹åŒ–
  â”‚     â†’ é‡æ–°æ³¨å†Œæ‰€æœ‰æŠ€èƒ½
  â”‚     â†“
  â”‚     âœ“ ä¸éœ€è¦é‡å¯ç¼–è¾‘å™¨ï¼
```

---

## ğŸ¯ å…³é”®æŠ€æœ¯ç‚¹æ€»ç»“

### 1. ä¸ºä»€ä¹ˆæ˜¯ DLL è€Œä¸æ˜¯é™æ€åº“ï¼Ÿ

|é™æ€åº“ (.lib)|DLL (.dll)|
|---|---|
|ä»£ç è¢«å¤åˆ¶åˆ°æ¯ä¸ªå¼•ç”¨è€…|ä»£ç åªæœ‰ä¸€ä»½ï¼Œå…±äº«å†…å­˜|
|ä¿®æ”¹åå¿…é¡»é‡æ–°é“¾æ¥æ‰€æœ‰å¼•ç”¨è€…|ä¿®æ”¹ååªéœ€æ›¿æ¢ DLL|
|æ— æ³•çƒ­é‡è½½|**æ”¯æŒçƒ­é‡è½½** âœ“|
|å¯åŠ¨é€Ÿåº¦å¿«|å¯åŠ¨éœ€è¦è§£æä¾èµ–|

**UE é€‰æ‹© DLL çš„åŸå› **ï¼š

- æ”¯æŒ Live Codingï¼ˆä¸é‡å¯ç¼–è¾‘å™¨æ›´æ–°ä»£ç ï¼‰
- æ¨¡å—åŒ–å¼€å‘ï¼ˆå¼•æ“å’Œæ¸¸æˆåˆ†ç¦»ï¼‰
- å‡å°‘å†…å­˜å ç”¨ï¼ˆå¤šä¸ªè¿›ç¨‹å…±äº«å¼•æ“ DLLï¼‰

### 2. Pre-Main è‡ªæ³¨å†Œçš„æœ¬è´¨

```
ä¼ ç»Ÿæ–¹å¼ï¼ˆéœ€è¦ä¿®æ”¹ Managerï¼‰ï¼š
  SkillManager.cpp:
    void Init() {
        RegisterSkill("Fireball", []() { return new Fireball(); });
        RegisterSkill("IceShard", []() { return new IceShard(); }); // æ‰‹åŠ¨æ·»åŠ 
    }

è‡ªæ³¨å†Œæ–¹å¼ï¼ˆä¸éœ€è¦ä¿®æ”¹ä»»ä½•ä»£ç ï¼‰ï¼š
  Skill_Fireball.cpp:
    static auto _ = []() {  // åŒ¿åé™æ€å˜é‡
        SkillManager::Get().RegisterSkill(...);
        return 0;
    }();
  
  ç¼–è¯‘å™¨å°†è¿™ä¸ªé™æ€å˜é‡çš„åˆå§‹åŒ–å‡½æ•°æ³¨å†Œåˆ° .CRT$XCU æ®µ
  Windows åŠ è½½å™¨åœ¨ DLL åŠ è½½æ—¶è‡ªåŠ¨è°ƒç”¨
```

### 3. è™šå‡½æ•°è¡¨çš„è¿è¡Œæ—¶è§’è‰²

```
ç¼–è¯‘æ—¶ï¼š
  ç¼–è¯‘å™¨ä¸ºæ¯ä¸ªç±»ç”Ÿæˆ VTable
  FFireballSkill çš„ VTable:
    [0] ~FFireballSkill()
    [1] FFireballSkill::Execute()  â† åœ°å€åœ¨é“¾æ¥æ—¶ç¡®å®š
    [2] FFireballSkill::GetName()

è¿è¡Œæ—¶ï¼š
  ISkill* skill = spawner();  // åˆ›å»ºå¯¹è±¡
  
  å¯¹è±¡å†…å­˜å¸ƒå±€ï¼š
  [0-7]   vptr â†’ æŒ‡å‘ FFireballSkill çš„ VTable
  [8-15]  æˆå‘˜å˜é‡ ...
  
  skill->Execute(caster);
  
  æ±‡ç¼–ä»£ç ï¼š
    mov rax, [skill]        ; è¯»å– vptr
    call [rax+8]            ; è°ƒç”¨ vtable[1]
```

### 4. Build.cs çš„æ¯è¡Œä»£ç éƒ½å¯¹åº”å®é™…æ“ä½œ

|Build.cs é…ç½®|ç¼–è¯‘å™¨å‚æ•°|é“¾æ¥å™¨å‚æ•°|
|---|---|---|
|`PublicDependencyModuleNames.Add("Core")`|`/I Engine/Runtime/Core/Public`|`UE5Editor-Core.lib`|
|`PrivateDependencyModuleNames.Add("Slate")`|`/I Engine/Runtime/Slate/Public`<br>(ä»…æœ¬æ¨¡å—å¯è§)|`UE5Editor-Slate.lib`|
|`PublicDefinitions.Add("SKILL_DEBUG=1")`|`/D "SKILL_DEBUG=1"`|æ— |
|`OptimizeCode = Never`|`/Od` (Debug)|æ— |
|`bEnableExceptions = true`|`/EHsc`|æ— |

---

## ğŸ§ª å®éªŒå»ºè®®

1. **éªŒè¯ Pre-Main**ï¼š
    
    ```cpp
    // SkillRegistrar.h
    struct FSkillRegistrar {
        FSkillRegistrar(FString Name, ...) {
            UE_LOG(LogTemp, Warning, TEXT("ğŸ”¹ PRE-MAIN: Registering %s"), *Name);
            // åœ¨è¿™é‡Œæ‰“æ–­ç‚¹ï¼ŒéªŒè¯å®ƒç¡®å®åœ¨ main() ä¹‹å‰æ‰§è¡Œ
        }
    };
    ```
    
2. **ç ´åæ€§æµ‹è¯•**ï¼š
    
    - åœ¨ `ISkill` ä¸­é—´æ’å…¥ä¸€ä¸ªæ–°è™šå‡½æ•°
    - åªé‡æ–°ç¼–è¯‘ `SkillManager`ï¼Œä¸é‡æ–°ç¼–è¯‘ `Skill_Fireball`
    - è§‚å¯Ÿå´©æºƒï¼ˆVTable åç§»é”™ä¹±ï¼‰
3. **æ€§èƒ½å¯¹æ¯”**ï¼š
    
    - åˆ›å»º 1000 ä¸ªæŠ€èƒ½æ–‡ä»¶
    - æµ‹è¯•å¢é‡ç¼–è¯‘æ—¶é—´ï¼ˆä¿®æ”¹ä¸€ä¸ªæŠ€èƒ½ï¼‰
    - å¯¹æ¯” Unity çš„ asmdef é‡æ–°ç¼–è¯‘æ•´ä¸ªç¨‹åºé›†

---

è¿™å°±æ˜¯ **Project "Phantom Link"** ä» Build.cs é…ç½®åˆ°è¿è¡Œæ—¶å¤šæ€è°ƒç”¨çš„å®Œæ•´æ—…ç¨‹ã€‚æ¯ä¸€ä¸ªç¯èŠ‚éƒ½ä¸¥æ ¼éµå¾ª C++ çš„ç¼–è¯‘æ¨¡å‹ï¼Œè€Œ UE çš„æ¨¡å—ç³»ç»Ÿåˆ™æ˜¯åœ¨è¿™ä¸ªåŸºç¡€ä¸Šæ„å»ºçš„"å…ƒç³»ç»Ÿ"ã€‚

ä½ ç°åœ¨èƒ½ç†è§£ä¸ºä»€ä¹ˆ UE çš„ç¼–è¯‘å¦‚æ­¤å¤æ‚ï¼Œä»¥åŠä¸ºä»€ä¹ˆå®ƒèƒ½åšåˆ° Live Coding äº†å—ï¼Ÿ
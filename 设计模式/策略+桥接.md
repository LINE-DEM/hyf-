# è®¾è®¡æ¨¡å¼é€ŸæŸ¥ï¼šç­–ç•¥æ¨¡å¼ vs æ¡¥æ¥æ¨¡å¼

## ğŸ¯ ä¸€å¥è¯è®°å¿†

| æ¨¡å¼ | æ ¸å¿ƒè®°å¿†ç‚¹ |
|------|-----------|
| **ç­–ç•¥æ¨¡å¼** | ä¸€ä¸ªç±»ï¼Œå¤šç§ç®—æ³•ï¼Œ**è¿è¡Œæ—¶åˆ‡æ¢** |
| **æ¡¥æ¥æ¨¡å¼** | å¤šä¸ªç±»ï¼Œå¤šç§å®ç°ï¼Œ**ä¸¤ä¸ªç»´åº¦ç‹¬ç«‹å˜åŒ–** |

---

## ğŸ“Š å¿«é€Ÿå¯¹æ¯”è¡¨

| ç»´åº¦ | ç­–ç•¥æ¨¡å¼ | æ¡¥æ¥æ¨¡å¼ |
|------|---------|---------|
| **æŠ½è±¡å±‚** | **å•ä¸ªç±»**ï¼ˆContextï¼‰ | **ç»§æ‰¿ä½“ç³»**ï¼ˆå¤šä¸ªå­ç±»ï¼‰ |
| **å˜åŒ–ç»´åº¦** | **1ä¸ª**ï¼ˆç®—æ³•å˜åŒ–ï¼‰ | **2ä¸ª**ï¼ˆæŠ½è±¡+å®ç°éƒ½å˜åŒ–ï¼‰ |
| **åˆ‡æ¢æ—¶æœº** | **è¿è¡Œæ—¶**åŠ¨æ€åˆ‡æ¢ | **ç¼–è¯‘æ—¶**/æ„é€ æ—¶ç¡®å®š |
| **ä¸»è¦ç›®çš„** | è®©ç®—æ³•å¯æ›¿æ¢ | è®©ä¸¤ä¸ªç»´åº¦è§£è€¦ |
| **ç±»æ•°é‡** | 1 + Nä¸ªç­–ç•¥ | N + Mï¼ˆè€Œä¸æ˜¯NÃ—Mï¼‰ |

---

## ğŸ” å¿«é€Ÿè¯†åˆ«æ³•

### é—®è‡ªå·±3ä¸ªé—®é¢˜ï¼š

1. **æœ‰å‡ ä¸ªç»´åº¦åœ¨å˜åŒ–ï¼Ÿ**
   - 1ä¸ª â†’ å¯èƒ½æ˜¯ç­–ç•¥æ¨¡å¼
   - 2ä¸ª+ â†’ è€ƒè™‘æ¡¥æ¥æ¨¡å¼

2. **æŠ½è±¡å±‚æœ‰ç»§æ‰¿ä½“ç³»å—ï¼Ÿ**
   - æ²¡æœ‰ï¼ˆå•ä¸ªç±»ï¼‰ â†’ ç­–ç•¥æ¨¡å¼
   - æœ‰ï¼ˆå¤šä¸ªå­ç±»ï¼‰ â†’ æ¡¥æ¥æ¨¡å¼

3. **éœ€è¦è¿è¡Œæ—¶åˆ‡æ¢å—ï¼Ÿ**
   - æ˜¯ â†’ ç­–ç•¥æ¨¡å¼
   - å¦ï¼ˆæ¯ç§ç±»å‹å›ºå®šä¸€ç§å®ç°ï¼‰ â†’ æ¡¥æ¥æ¨¡å¼

---

## ğŸ’» ç­–ç•¥æ¨¡å¼ - ä»£ç æ¨¡æ¿

### ç»“æ„å›¾
```
Context (ä½¿ç”¨ç±»)
   â†“ æŒæœ‰ (è¿è¡Œæ—¶å¯åˆ‡æ¢)
IStrategy æ¥å£
   â†“ å®ç°
ConcreteStrategyA, ConcreteStrategyB...
```

### æ ‡å‡†å®ç°

```csharp
// 1. å®šä¹‰ç­–ç•¥æ¥å£
public interface IStrategy
{
    void Execute();
}

// 2. å…·ä½“ç­–ç•¥å®ç°
public class ConcreteStrategyA : IStrategy
{
    public void Execute() 
    { 
        Debug.Log("Strategy A"); 
    }
}

public class ConcreteStrategyB : IStrategy
{
    public void Execute() 
    { 
        Debug.Log("Strategy B"); 
    }
}

// 3. ä½¿ç”¨ç­–ç•¥çš„ç±»ï¼ˆContextï¼‰
public class Context
{
    private IStrategy strategy;  // æŒæœ‰æ¥å£
    
    // å¯ä»¥è¿è¡Œæ—¶åˆ‡æ¢
    public void SetStrategy(IStrategy newStrategy)
    {
        strategy = newStrategy;
    }
    
    public void DoWork()
    {
        strategy.Execute();  // å§”æ‰˜ç»™ç­–ç•¥
    }
}

// 4. ä½¿ç”¨æ–¹å¼
Context context = new Context();
context.SetStrategy(new ConcreteStrategyA());  // è¿è¡Œæ—¶åˆ‡æ¢
context.DoWork();
context.SetStrategy(new ConcreteStrategyB());  // åˆåˆ‡æ¢äº†
context.DoWork();
```

### Unity å®æˆ˜æ¡ˆä¾‹ï¼šæ•ŒäººAIè¡Œä¸º

```csharp
// ç­–ç•¥æ¥å£
public interface IAIBehavior
{
    void Execute(Enemy enemy);
}

// å…·ä½“ç­–ç•¥
public class AggressiveBehavior : IAIBehavior
{
    public void Execute(Enemy enemy)
    {
        enemy.ChasePlayer();
        enemy.Attack();
    }
}

public class DefensiveBehavior : IAIBehavior
{
    public void Execute(Enemy enemy)
    {
        enemy.Patrol();
        if (enemy.IsInDanger())
            enemy.Retreat();
    }
}

// æ•Œäººç±»ï¼ˆContextï¼‰
public class Enemy : MonoBehaviour
{
    private IAIBehavior behavior;
    
    // å¯ä»¥æ ¹æ®æƒ…å†µåˆ‡æ¢è¡Œä¸º
    void Update()
    {
        // è¡€é‡ä½æ—¶åˆ‡æ¢ä¸ºé˜²å¾¡è¡Œä¸º
        if (health < 30f)
            SetBehavior(new DefensiveBehavior());
        
        behavior.Execute(this);
    }
    
    public void SetBehavior(IAIBehavior newBehavior)
    {
        behavior = newBehavior;
    }
}
```

---

## ğŸŒ‰ æ¡¥æ¥æ¨¡å¼ - ä»£ç æ¨¡æ¿

### ç»“æ„å›¾
```
æŠ½è±¡å±‚ï¼ˆæœ‰ç»§æ‰¿ä½“ç³»ï¼‰
Abstraction
   â”œâ”€ RefinedAbstractionA
   â””â”€ RefinedAbstractionB
        â†“ æŒæœ‰ï¼ˆç¼–è¯‘æ—¶ç¡®å®šï¼‰
å®ç°å±‚æ¥å£
IImplementation
   â”œâ”€ ConcreteImplementation1
   â””â”€ ConcreteImplementation2
```

### æ ‡å‡†å®ç°

```csharp
// 1. å®ç°å±‚æ¥å£ï¼ˆç»´åº¦2ï¼‰
public interface IImplementation
{
    void OperationImpl();
}

// 2. å…·ä½“å®ç°
public class ConcreteImplementation1 : IImplementation
{
    public void OperationImpl() 
    { 
        Debug.Log("Implementation 1"); 
    }
}

public class ConcreteImplementation2 : IImplementation
{
    public void OperationImpl() 
    { 
        Debug.Log("Implementation 2"); 
    }
}

// 3. æŠ½è±¡å±‚åŸºç±»ï¼ˆç»´åº¦1ï¼‰
public abstract class Abstraction
{
    protected IImplementation implementation;  // æŒæœ‰æ¥å£ï¼ˆæ¡¥ï¼ï¼‰
    
    // å­ç±»å†³å®šç”¨å“ªä¸ªå®ç°
    protected abstract IImplementation GetImplementation();
    
    protected virtual void Awake()
    {
        implementation = GetImplementation();
    }
    
    public void Operation()
    {
        // ä½¿ç”¨å®ç°å±‚
        implementation.OperationImpl();
        // è‡ªå·±çš„é€»è¾‘
        SpecificLogic();
    }
    
    protected abstract void SpecificLogic();
}

// 4. å…·ä½“æŠ½è±¡ç±»
public class RefinedAbstractionA : Abstraction
{
    protected override IImplementation GetImplementation()
    {
        return new ConcreteImplementation1();  // ç¼–è¯‘æ—¶ç¡®å®š
    }
    
    protected override void SpecificLogic()
    {
        Debug.Log("Logic A");
    }
}

public class RefinedAbstractionB : Abstraction
{
    protected override IImplementation GetImplementation()
    {
        return new ConcreteImplementation2();
    }
    
    protected override void SpecificLogic()
    {
        Debug.Log("Logic B");
    }
}

// 5. ä½¿ç”¨æ–¹å¼
Abstraction objA = new RefinedAbstractionA();  // Aé…å®ç°1
Abstraction objB = new RefinedAbstractionB();  // Bé…å®ç°2
objA.Operation();
objB.Operation();
```

### Unity å®æˆ˜æ¡ˆä¾‹ï¼šæ­¦å™¨ç³»ç»Ÿ

```csharp
// å®ç°å±‚ï¼šç‰¹æ•ˆç³»ç»Ÿï¼ˆç»´åº¦2ï¼‰
public interface IWeaponEffect
{
    void PlayAttackEffect(Vector3 position);
    void PlayHitEffect(Vector3 hitPoint);
}

// ç²’å­ç‰¹æ•ˆ
public class ParticleEffect : MonoBehaviour, IWeaponEffect
{
    public ParticleSystem attackPS;
    
    public void PlayAttackEffect(Vector3 position)
    {
        attackPS.transform.position = position;
        attackPS.Play();
    }
    
    public void PlayHitEffect(Vector3 hitPoint)
    {
        // æ’­æ”¾å‘½ä¸­ç²’å­
    }
}

// SpineåŠ¨ç”»ç‰¹æ•ˆ
public class SpineEffect : MonoBehaviour, IWeaponEffect
{
    public SkeletonAnimation skeleton;
    
    public void PlayAttackEffect(Vector3 position)
    {
        skeleton.AnimationState.SetAnimation(0, "attack", false);
    }
    
    public void PlayHitEffect(Vector3 hitPoint)
    {
        // æ’­æ”¾å‘½ä¸­åŠ¨ç”»
    }
}

// æŠ½è±¡å±‚ï¼šæ­¦å™¨ï¼ˆç»´åº¦1ï¼‰
public abstract class Weapon : MonoBehaviour
{
    protected IWeaponEffect effect;  // æ¡¥æ¥ï¼šæŒæœ‰ç‰¹æ•ˆæ¥å£
    
    protected abstract IWeaponEffect GetEffect();
    
    void Awake()
    {
        effect = GetEffect();
    }
    
    public void Attack(Vector3 target)
    {
        // æ’­æ”¾ç‰¹æ•ˆï¼ˆä½¿ç”¨å®ç°å±‚ï¼‰
        effect.PlayAttackEffect(transform.position);
        
        // æ­¦å™¨ç‰¹æœ‰é€»è¾‘ï¼ˆå­ç±»å®ç°ï¼‰
        PerformAttackLogic(target);
        
        // å‘½ä¸­ç‰¹æ•ˆ
        effect.PlayHitEffect(target);
    }
    
    protected abstract void PerformAttackLogic(Vector3 target);
}

// å…·ä½“æ­¦å™¨ï¼šå‰‘
public class Sword : Weapon
{
    protected override IWeaponEffect GetEffect()
    {
        return gameObject.AddComponent<ParticleEffect>();  // å‰‘ç”¨ç²’å­
    }
    
    protected override void PerformAttackLogic(Vector3 target)
    {
        // è¿‘æˆ˜èŒƒå›´æ£€æµ‹
        Debug.Log("Sword slash!");
    }
}

// å…·ä½“æ­¦å™¨ï¼šå¼“
public class Bow : Weapon
{
    protected override IWeaponEffect GetEffect()
    {
        return gameObject.AddComponent<SpineEffect>();  // å¼“ç”¨Spine
    }
    
    protected override void PerformAttackLogic(Vector3 target)
    {
        // å‘å°„ç®­çŸ¢
        Debug.Log("Shoot arrow!");
    }
}
```

---

## ğŸ”„ ç»„åˆä½¿ç”¨ï¼šç­–ç•¥+æ¡¥æ¥

### ä½•æ—¶ç»„åˆï¼Ÿ

å½“ä½ éœ€è¦ï¼š
1. **ä¸¤ä¸ªç»´åº¦éƒ½è¦ç‹¬ç«‹å˜åŒ–**ï¼ˆæ¡¥æ¥ï¼‰
2. **å…¶ä¸­ä¸€ä¸ªç»´åº¦è¿˜è¦è¿è¡Œæ—¶åˆ‡æ¢**ï¼ˆç­–ç•¥ï¼‰

### ä»£ç ç¤ºä¾‹

```csharp
// å®ç°å±‚æ¥å£ï¼ˆæ¡¥æ¥çš„ä¸€ç«¯ï¼‰
public interface IWeaponEffect
{
    void PlayEffect();
}

public class ParticleEffect : IWeaponEffect
{
    public void PlayEffect() { /* ç²’å­ */ }
}

public class SpineEffect : IWeaponEffect
{
    public void PlayEffect() { /* Spine */ }
}

// æŠ½è±¡å±‚ï¼ˆæ¡¥æ¥çš„å¦ä¸€ç«¯ + ç­–ç•¥ï¼‰
public abstract class Weapon : MonoBehaviour
{
    protected IWeaponEffect effect;  // æ¡¥æ¥ï¼šæŒæœ‰æ¥å£
    
    // ç­–ç•¥ï¼šå¯ä»¥è¿è¡Œæ—¶åˆ‡æ¢ç‰¹æ•ˆ
    public void SetEffect(IWeaponEffect newEffect)
    {
        effect = newEffect;
    }
    
    public void Attack()
    {
        effect.PlayEffect();
        PerformAttackLogic();  // å­ç±»å®ç°
    }
    
    protected abstract void PerformAttackLogic();
}

public class Sword : Weapon
{
    protected override void PerformAttackLogic()
    {
        // å‰‘çš„é€»è¾‘
    }
}

public class Bow : Weapon
{
    protected override void PerformAttackLogic()
    {
        // å¼“çš„é€»è¾‘
    }
}

// ä½¿ç”¨æ–¹å¼
Sword sword = new Sword();
sword.SetEffect(new ParticleEffect());  // å…ˆç”¨ç²’å­
sword.Attack();
sword.SetEffect(new SpineEffect());     // åˆ‡æ¢æˆSpine
sword.Attack();

Bow bow = new Bow();
bow.SetEffect(new ParticleEffect());    // å¼“ä¹Ÿèƒ½ç”¨ç²’å­
bow.Attack();
```

**è¯†åˆ«ç‰¹å¾**ï¼š
- âœ… æœ‰ç»§æ‰¿ä½“ç³»ï¼ˆSword, Bowï¼‰
- âœ… æŒæœ‰æ¥å£ï¼ˆIWeaponEffectï¼‰
- âœ… å¯ä»¥è¿è¡Œæ—¶åˆ‡æ¢ï¼ˆSetEffectï¼‰

---

## ğŸ® Unity å®æˆ˜åœºæ™¯é€‰æ‹©

### ç”¨ç­–ç•¥æ¨¡å¼ï¼š

| åœºæ™¯ | åŸå›  |
|------|------|
| æ•ŒäººAIçŠ¶æ€åˆ‡æ¢ | éœ€è¦è¿è¡Œæ—¶æ ¹æ®æƒ…å†µåˆ‡æ¢è¡Œä¸º |
| å¯»è·¯ç®—æ³•åˆ‡æ¢ | A*ã€å¯¼èˆªç½‘æ ¼ã€ç›´çº¿è¿½è¸ªå¯åˆ‡æ¢ |
| è¾“å…¥å¤„ç† | PCé”®é¼ ã€æ‰‹æŸ„ã€è§¦æ‘¸å¯åˆ‡æ¢ |
| æ’åºç®—æ³• | å¿«æ’ã€å½’å¹¶ã€å†’æ³¡æ ¹æ®æ•°æ®é‡é€‰æ‹© |

### ç”¨æ¡¥æ¥æ¨¡å¼ï¼š

| åœºæ™¯ | ä¸¤ä¸ªç»´åº¦ |
|------|---------|
| UIæ–‡æœ¬ç³»ç»Ÿ | æ–‡æœ¬åŠŸèƒ½ï¼ˆè‡ªåŠ¨ç”Ÿé•¿ã€è¶…é“¾æ¥ï¼‰ Ã— æ¸²æŸ“æ–¹å¼ï¼ˆTextã€TMPï¼‰ |
| æ­¦å™¨ç³»ç»Ÿ | æ­¦å™¨ç±»å‹ï¼ˆå‰‘ã€å¼“ã€æ³•æ–ï¼‰ Ã— ç‰¹æ•ˆç³»ç»Ÿï¼ˆç²’å­ã€Spineã€Shaderï¼‰ |
| è§’è‰²ç³»ç»Ÿ | è§’è‰²ç±»å‹ï¼ˆæˆ˜å£«ã€æ³•å¸ˆï¼‰ Ã— æ¸²æŸ“æ–¹å¼ï¼ˆ2Dã€3Dï¼‰ |
| å¹³å°é€‚é… | æ¸¸æˆé€»è¾‘ Ã— å¹³å°APIï¼ˆiOSã€Androidã€PCï¼‰ |

### ç»„åˆä½¿ç”¨ï¼š

| åœºæ™¯ | è¯´æ˜ |
|------|------|
| é«˜çº§æ­¦å™¨ç³»ç»Ÿ | æ­¦å™¨æœ‰ç»§æ‰¿ä½“ç³»ï¼Œç‰¹æ•ˆå¯è¿è¡Œæ—¶æ¢ |
| æŠ€èƒ½ç³»ç»Ÿ | æŠ€èƒ½åˆ†ç±»å‹ï¼Œè¡¨ç°æ•ˆæœå¯åˆ‡æ¢ |
| UIä¸»é¢˜ç³»ç»Ÿ | UIç»„ä»¶æœ‰å±‚çº§ï¼Œä¸»é¢˜å¯åŠ¨æ€æ¢ |

---

## âš¡ è®°å¿†å£è¯€

### ç­–ç•¥æ¨¡å¼
```
ä¸€ä¸ªContextï¼Œå¤šç§Strategy
è¿è¡Œæ—¶åˆ‡æ¢ï¼Œç®—æ³•å¯æ›¿ä»£
æ²¡æœ‰ç»§æ‰¿ï¼Œæ¥å£æ¥å§”æ‰˜
```

### æ¡¥æ¥æ¨¡å¼
```
ä¸¤ä¸ªç»´åº¦ï¼Œå„è‡ªç‹¬ç«‹
æŠ½è±¡å®ç°ï¼Œç”¨æ¡¥è¿æ¥
ç»§æ‰¿ä½“ç³»ï¼Œç»„åˆæ¥å£
N+Mä¸ªç±»ï¼Œä¸æ˜¯NÃ—M
```

---

## ğŸš¨ å¸¸è§è¯¯åŒº

### è¯¯åŒº1ï¼šåªè¦æŒæœ‰æ¥å£å°±æ˜¯æ¡¥æ¥ï¼Ÿ
âŒ **é”™è¯¯**ï¼š`class A { IInterface i; }` å°±æ˜¯æ¡¥æ¥
âœ… **æ­£ç¡®**ï¼šè¿˜è¦çœ‹Aæ˜¯å¦æœ‰ç»§æ‰¿ä½“ç³»ï¼Œæ˜¯å¦ä¸¤ä¸ªç»´åº¦éƒ½åœ¨å˜åŒ–

### è¯¯åŒº2ï¼šæ¡¥æ¥ä¸èƒ½è¿è¡Œæ—¶åˆ‡æ¢ï¼Ÿ
âŒ **é”™è¯¯**ï¼šæ¡¥æ¥ä¸€å®šæ˜¯ç¼–è¯‘æ—¶å›ºå®šçš„
âœ… **æ­£ç¡®**ï¼šå¯ä»¥ç»„åˆç­–ç•¥æ¨¡å¼ï¼Œè®©å…¶ä¸­ä¸€ç«¯å¯åˆ‡æ¢

### è¯¯åŒº3ï¼šä¸ºäº†å‡å°‘if-elseç”¨æ¡¥æ¥ï¼Ÿ
âŒ **é”™è¯¯**ï¼šå‡å°‘if-elseæ˜¯ç›®çš„
âœ… **æ­£ç¡®**ï¼šè®©ä¸¤ä¸ªç»´åº¦è§£è€¦æ˜¯ç›®çš„ï¼Œå‡å°‘if-elseæ˜¯å‰¯ä½œç”¨

---

## ğŸ“ å¿«é€Ÿæ£€æŸ¥æ¸…å•

**é‡åˆ°è®¾è®¡é—®é¢˜æ—¶ï¼Œé—®è‡ªå·±ï¼š**

- [ ] æœ‰å‡ ä¸ªç»´åº¦åœ¨å˜åŒ–ï¼Ÿï¼ˆ1ä¸ªâ†’ç­–ç•¥ï¼Œ2ä¸ªâ†’æ¡¥æ¥ï¼‰
- [ ] æŠ½è±¡å±‚æœ‰å¤šä¸ªå­ç±»å—ï¼Ÿï¼ˆæ²¡æœ‰â†’ç­–ç•¥ï¼Œæœ‰â†’æ¡¥æ¥ï¼‰
- [ ] éœ€è¦è¿è¡Œæ—¶åˆ‡æ¢å—ï¼Ÿï¼ˆéœ€è¦â†’ç­–ç•¥æˆ–ç»„åˆï¼‰
- [ ] å¦‚æœä¸ç”¨æ¨¡å¼ï¼Œä¼šç±»çˆ†ç‚¸å—ï¼Ÿï¼ˆä¼šâ†’æ¡¥æ¥ï¼‰
- [ ] ä¸»è¦æ˜¯ç®—æ³•æ›¿æ¢å—ï¼Ÿï¼ˆæ˜¯â†’ç­–ç•¥ï¼‰
- [ ] ä¸¤ä¸ªç»´åº¦éƒ½ä¼šæ‰©å±•å—ï¼Ÿï¼ˆæ˜¯â†’æ¡¥æ¥ï¼‰

---

## ğŸ“ æ‰©å±•é˜…è¯»

- **ç­–ç•¥æ¨¡å¼**ï¼šGoF è®¾è®¡æ¨¡å¼ - è¡Œä¸ºå‹æ¨¡å¼
- **æ¡¥æ¥æ¨¡å¼**ï¼šGoF è®¾è®¡æ¨¡å¼ - ç»“æ„å‹æ¨¡å¼
- **ç›¸å…³æ¨¡å¼**ï¼šé€‚é…å™¨æ¨¡å¼ã€çŠ¶æ€æ¨¡å¼ã€å·¥å‚æ¨¡å¼

---

**æœ€åæé†’**ï¼šæ¨¡å¼ä¸æ˜¯é“¶å¼¹ï¼Œæ ¹æ®å®é™…åœºæ™¯é€‰æ‹©ã€‚ç®€å•é—®é¢˜ç”¨ç®€å•æ–¹æ¡ˆï¼Œä¸è¦è¿‡åº¦è®¾è®¡ï¼
